/*! For license information please see MultiClass.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[448],{1623:function(t,e,r){"use strict";r.r(e);var n=r(16),a=r.n(n),i=r(26),o=r.n(i),s=r(19),c=r.n(s),l=r(37),u=r.n(l),h=r(13),d=r.n(h),f=r(24),p=r.n(f),v=r(20),m=r.n(v),g=r(50),y=r.n(g),w=r(23),x=r.n(w),b=r(1653),k=r(88),L=r(1692),C=r(74),S=r.n(C);function T(){T=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=m.a||function(t,e,r){t[e]=r.value},s="function"==typeof p.a?p.a:{},l=s.iterator||"@@iterator",h=s.asyncIterator||"@@asyncIterator",f=s.toStringTag||"@@toStringTag";function v(t,e,r){return m()(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{v({},"")}catch(t){v=function(t,e,r){return t[e]=r}}function g(t,e,r,n){var a=e&&e.prototype instanceof k?e:k,o=d()(a.prototype),s=new G(n||[]);return i(o,"_invoke",{value:j(t,r,s)}),o}function y(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=g;var w="suspendedStart",_="executing",x="completed",b={};function k(){}function L(){}function C(){}var S={};v(S,l,(function(){return this}));var E=u.a,M=E&&E(E(O([])));M&&M!==r&&n.call(M,l)&&(S=M);var I=C.prototype=k.prototype=d()(S);function N(t){["next","throw","return"].forEach((function(e){v(t,e,(function(t){return this._invoke(e,t)}))}))}function V(t,e){function r(a,i,o,s){var l=y(t[a],t,i);if("throw"!==l.type){var u=l.arg,h=u.value;return h&&"object"==c()(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,o,s)}),(function(t){r("throw",t,o,s)})):e.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return r("throw",t,o,s)}))}s(l.arg)}var a;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,a){r(t,n,e,a)}))}return a=a?a.then(i,i):i()}})}function j(e,r,n){var a=w;return function(i,o){if(a===_)throw Error("Generator is already running");if(a===x){if("throw"===i)throw o;return{value:t,done:!0}}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var c=$(s,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===w)throw a=x,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=_;var l=y(e,r,n);if("normal"===l.type){if(a=n.done?x:"suspendedYield",l.arg===b)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(a=x,n.method="throw",n.arg=l.arg)}}}function $(e,r){var n=r.method,a=e.iterator[n];if(a===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,$(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=y(a,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function F(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function z(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function G(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(F,this),this.reset(!0)}function O(e){if(e||""===e){var r=e[l];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,i=function r(){for(;++a<e.length;)if(n.call(e,a))return r.value=e[a],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(c()(e)+" is not iterable")}return L.prototype=C,i(I,"constructor",{value:C,configurable:!0}),i(C,"constructor",{value:L,configurable:!0}),L.displayName=v(C,f,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===L||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return o.a?o()(t,C):(t.__proto__=C,v(t,f,"GeneratorFunction")),t.prototype=d()(I),t},e.awrap=function(t){return{__await:t}},N(V.prototype),v(V.prototype,h,(function(){return this})),e.AsyncIterator=V,e.async=function(t,r,n,i,o){void 0===o&&(o=a.a);var s=new V(g(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},N(I),v(I,f,"Generator"),v(I,l,(function(){return this})),v(I,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=O,G.prototype={constructor:G,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(z),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function a(n,a){return s.type="throw",s.arg=e,r.next=n,a&&(r.method="next",r.arg=t),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var c=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),z(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var a=n.arg;z(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:O(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}var E={name:"CopyMultiClassModal",props:{visible:{type:Boolean,required:!0},id:{type:[String,Number],required:!0}},data:function(){return{confirmLoading:!1,form:this.$form.createForm(this,{name:"copy_multi_class"}),product:{list:[],flag:!0,initialValue:void 0,paging:{pageSize:10,current:0}},teacher:{list:[],title:"",flag:!0,initialValue:void 0,paging:{pageSize:10,current:0}},assistant:{list:[],title:"",flag:!0,initialValue:[],paging:{pageSize:10,current:0}}}},watch:{visible:function(t,e){t&&this.fetchMultiClass()}},methods:{initFetch:function(){this.fetchProduct(),this.fetchTeacher(),this.fetchAssistant()},duplicateRemoval:function(t,e){S.a.forEach(t,(function(r,n){if(r.id==e)return t.splice(n,1),!1}))},disabledTeacher:function(t){var e=this,r=t||this.form.getFieldValue("assistantIds")||this.assistant.initialValue;S.a.forEach(r,(function(t){S.a.forEach(e.teacher.list,(function(e){e.id!=t?S.a.includes(r,e.id)||(e.disabled=!1):e.disabled=!0}))}))},disabledAssistant:function(t){var e=t||this.form.getFieldValue("teacherId")||this.teacher.initialValue;S.a.forEach(this.assistant.list,(function(t){t.id==e?t.disabled=!0:t.disabled=!1}))},fetchMultiClass:function(){var t=this;k.u.get(this.id).then((function(e){var r=e.title,n=e.course.courseSetTitle,a=e.product,i=e.productId,o=e.teachers,s=e.teacherIds,c=e.assistants,l=e.assistantIds;t.form.setFieldsValue({title:"".concat(r,"(复制)"),courseSetTitle:"".concat(n,"(复制)")}),t.product.list=[a],t.product.initialValue=i,t.teacher.list=o,t.teacher.initialValue=s[0],t.assistant.list=c,t.assistant.initialValue=l,t.initFetch()}))},fetchProduct:function(){var t=this,e=this.product.paging,r=e.pageSize,n={limit:r,offset:r*e.current};k.x.search(n).then((function(e){t.product.paging.current++,t.product.initialValue&&t.duplicateRemoval(e.data,t.product.initialValue),t.product.list=S.a.concat(t.product.list,e.data),S.a.size(t.product.list)>=e.paging.total&&(t.product.flag=!1)}))},fetchTeacher:function(){var t=this,e=this.teacher,r=e.title,n=e.paging,a=n.pageSize,i={limit:a,offset:a*n.current};r&&(i.nickname=r),k.G.search(i).then((function(e){t.teacher.paging.current++,t.teacher.initialValue&&t.duplicateRemoval(e.data,t.teacher.initialValue),t.teacher.list=S.a.concat(t.teacher.list,e.data),S.a.size(t.teacher.list)>=e.paging.total&&(t.teacher.flag=!1),t.disabledTeacher()}))},fetchAssistant:function(){var t=this,e=this.assistant,r=e.title,n=e.paging,a=n.pageSize,i={limit:a,offset:a*n.current};r&&(i.nickname=r),k.b.search(i).then((function(e){t.assistant.paging.current++,S.a.forEach(t.assistant.initialValue,(function(r){t.duplicateRemoval(e.data,r)})),t.assistant.list=S.a.concat(t.assistant.list,e.data),S.a.size(t.assistant.list)>=e.paging.total&&(t.assistant.flag=!1),t.disabledAssistant()}))},validatorTitle:function(t,e,r){return x()(T().mark((function t(){var n;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.M.search({type:"multiClass",title:e});case 2:n=t.sent,n.result?r():r("产品名称不能与已创建的相同");case 5:case"end":return t.stop()}}),t)})))()},validatorTitleLength:function(t,e,r){e.replace(/[\u0391-\uFFE5]/g,"aa").length/2<=40?r():r("班课名称不能超过40个字符")},handleSearch:S.a.debounce((function(t,e){this[e]={list:[],title:t,flag:!0,paging:{pageSize:10,current:0}},this["fetch".concat(S.a.capitalize(e))]()}),300),handleChange:function(t,e){"teacher"!==e?"assistant"===e&&this.disabledTeacher(t):this.disabledAssistant(t)},handlePopupScroll:S.a.debounce((function(t,e){var r=t.target;r.scrollHeight-r.offsetHeight-20<r.scrollTop&&this[e].flag&&this["fetch".concat(S.a.capitalize(e))]()}),300),handleOk:function(t){var e=this;t.preventDefault(),this.form.validateFields(function(){var t=x()(T().mark((function t(r,n){var a;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r){t.next=7;break}return e.confirmLoading=!0,t.next=4,k.u.copyMultiClass(e.id,n);case 4:a=t.sent,a.success&&(e.$message.success("开始复制班课，复制成功后请在前台的通知页面中查看通知消息"),e.confirmLoading=!1,e.handleCancel());case 7:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}())},handleCancel:function(){this.form.resetFields(),this.$emit("event-communication",{event:"cancel-modal"})}}},M=E,I=r(22),N=Object(I.a)(M,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-modal",{attrs:{title:"复制班课",visible:t.visible,"confirm-loading":t.confirmLoading,"ok-text":"确定",cancelText:"取消",width:"900px"},on:{ok:t.handleOk,cancel:t.handleCancel}},[r("a-form",{attrs:{form:t.form,"label-col":{span:4},"wrapper-col":{span:20}}},[r("a-form-item",{attrs:{label:"班课名称"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["title",{trigger:"blur",rules:[{required:!0,message:"请填写班课名称"},{validator:t.validatorTitle},{validator:t.validatorTitleLength}]}],expression:"['title', {\n          trigger: 'blur',\n          rules: [\n            { required: true, message: '请填写班课名称' },\n            { validator: validatorTitle },\n            { validator: validatorTitleLength }\n          ]\n        }]"}],attrs:{placeholder:"请输入班课名称"}})],1),t._v(" "),r("a-form-item",{attrs:{label:"课程名称"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["courseSetTitle",{rules:[{required:!0,message:"请填写课程名称"},{max:40,message:"课程名称不能超过40个字"}]}],expression:"['courseSetTitle', { rules: [\n          { required: true, message: '请填写课程名称' },\n          { max: 40, message: '课程名称不能超过40个字' },\n        ]}]"}],attrs:{placeholder:"请输入课程名称"}})],1),t._v(" "),r("a-form-item",{attrs:{label:"所属产品"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["productId",{initialValue:t.product.initialValue,rules:[{required:!0,message:"请选择归属产品"}]}],expression:"['productId', {\n          initialValue: product.initialValue,\n          rules: [\n            { required: true, message: '请选择归属产品' }\n          ]\n        }]"}],attrs:{"show-search":"",placeholder:"请选择归属产品"},on:{search:function(e){return t.handleSearch(e,"product")},popupScroll:function(e){return t.handlePopupScroll(e,"product")}}},t._l(t.product.list,(function(e){return r("a-select-option",{key:e.id},[t._v("\n          "+t._s(e.title)+"\n        ")])})),1)],1),t._v(" "),r("a-form-item",{attrs:{label:"授课老师"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["teacherId",{initialValue:t.teacher.initialValue,rules:[{required:!0,message:"请选择授课老师"}]}],expression:"['teacherId', {\n          initialValue: teacher.initialValue,\n          rules: [\n            { required: true, message: '请选择授课老师' }\n          ]\n        }]"}],attrs:{"show-search":"","filter-option":!1,placeholder:"请选择授课教师"},on:{search:function(e){return t.handleSearch(e,"teacher")},change:function(e){return t.handleChange(e,"teacher")},popupScroll:function(e){return t.handlePopupScroll(e,"teacher")}}},t._l(t.teacher.list,(function(e){return r("a-select-option",{key:e.id,attrs:{disabled:e.disabled}},[t._v("\n          "+t._s(e.nickname)+"\n        ")])})),1)],1),t._v(" "),r("a-form-item",{attrs:{label:"助教"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["assistantIds",{initialValue:t.assistant.initialValue,rules:[{required:!0,message:"至少选择一位助教"}]}],expression:"['assistantIds', {\n          initialValue: assistant.initialValue,\n          rules: [\n            { required: true, message: '至少选择一位助教' }\n          ]\n        }]"}],attrs:{"show-search":"","filter-option":!1,mode:"multiple",placeholder:"请选择助教"},on:{search:function(e){return t.handleSearch(e,"assistant")},change:function(e){return t.handleChange(e,"assistant")},popupScroll:function(e){return t.handlePopupScroll(e,"assistant")}}},t._l(t.assistant.list,(function(e){return r("a-select-option",{key:e.id,attrs:{disabled:e.disabled}},[t._v("\n          "+t._s(e.nickname)+"\n        ")])})),1)],1)],1)],1)}),[],!1,null,null,null).exports;function V(){V=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=m.a||function(t,e,r){t[e]=r.value},s="function"==typeof p.a?p.a:{},l=s.iterator||"@@iterator",h=s.asyncIterator||"@@asyncIterator",f=s.toStringTag||"@@toStringTag";function v(t,e,r){return m()(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{v({},"")}catch(t){v=function(t,e,r){return t[e]=r}}function g(t,e,r,n){var a=e&&e.prototype instanceof k?e:k,o=d()(a.prototype),s=new G(n||[]);return i(o,"_invoke",{value:j(t,r,s)}),o}function y(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=g;var w="suspendedStart",_="executing",x="completed",b={};function k(){}function L(){}function C(){}var S={};v(S,l,(function(){return this}));var T=u.a,E=T&&T(T(O([])));E&&E!==r&&n.call(E,l)&&(S=E);var M=C.prototype=k.prototype=d()(S);function I(t){["next","throw","return"].forEach((function(e){v(t,e,(function(t){return this._invoke(e,t)}))}))}function N(t,e){function r(a,i,o,s){var l=y(t[a],t,i);if("throw"!==l.type){var u=l.arg,h=u.value;return h&&"object"==c()(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,o,s)}),(function(t){r("throw",t,o,s)})):e.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return r("throw",t,o,s)}))}s(l.arg)}var a;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,a){r(t,n,e,a)}))}return a=a?a.then(i,i):i()}})}function j(e,r,n){var a=w;return function(i,o){if(a===_)throw Error("Generator is already running");if(a===x){if("throw"===i)throw o;return{value:t,done:!0}}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var c=$(s,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===w)throw a=x,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=_;var l=y(e,r,n);if("normal"===l.type){if(a=n.done?x:"suspendedYield",l.arg===b)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(a=x,n.method="throw",n.arg=l.arg)}}}function $(e,r){var n=r.method,a=e.iterator[n];if(a===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,$(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=y(a,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function F(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function z(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function G(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(F,this),this.reset(!0)}function O(e){if(e||""===e){var r=e[l];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,i=function r(){for(;++a<e.length;)if(n.call(e,a))return r.value=e[a],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(c()(e)+" is not iterable")}return L.prototype=C,i(M,"constructor",{value:C,configurable:!0}),i(C,"constructor",{value:L,configurable:!0}),L.displayName=v(C,f,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===L||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return o.a?o()(t,C):(t.__proto__=C,v(t,f,"GeneratorFunction")),t.prototype=d()(M),t},e.awrap=function(t){return{__await:t}},I(N.prototype),v(N.prototype,h,(function(){return this})),e.AsyncIterator=N,e.async=function(t,r,n,i,o){void 0===o&&(o=a.a);var s=new N(g(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(M),v(M,f,"Generator"),v(M,l,(function(){return this})),v(M,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=O,G.prototype={constructor:G,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(z),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function a(n,a){return s.type="throw",s.arg=e,r.next=n,a&&(r.method="next",r.arg=t),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var c=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),z(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var a=n.arg;z(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:O(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}var j=[{title:"班课名称",dataIndex:"title",width:"150px",ellipsis:!0,scopedSlots:{customRender:"class_title"}},{title:"课程名称",dataIndex:"course",width:"150px",ellipsis:!0,scopedSlots:{customRender:"course"}},{title:"班课类型",dataIndex:"type",width:"120px",scopedSlots:{customRender:"type"}},{title:"班课状态",dataIndex:"status",width:"100px",scopedSlots:{customRender:"status"}},{title:"所属产品",dataIndex:"product",key:"productIds",width:"130px",ellipsis:!0,filters:[]},{title:"价格",dataIndex:"price",width:"100px",sorter:!0},{title:"已完成/课时",dataIndex:"taskNum",width:"120px",scopedSlots:{customRender:"taskNum"}},{title:"授课老师",dataIndex:"teacher",width:"150px"},{title:"助教老师",dataIndex:"assistant",width:"160px",scopedSlots:{customRender:"assistant"}},{title:"已报班人数",dataIndex:"studentNum",width:"130px",sorter:!0,scopedSlots:{customRender:"studentNum"}},{title:"最大服务人数",dataIndex:"maxServiceNum",width:"120px"},{title:"创建时间",dataIndex:"createdTime",width:"150px",sorter:!0,scopedSlots:{customRender:"createdTime"}},{title:"操作",dataIndex:"action",width:"200px",fixed:"right",scopedSlots:{customRender:"action"}}],$=[{status:"living",name:"开课中"},{status:"notStart",name:"未开课"},{status:"end",name:"已结课"}],F=[{status:"normal",name:"大班课"},{status:"group",name:"分组大班课"}],z={name:"MultiClassList",components:{AsideLayout:b.a,Assistant:L.a,CopyMultiClassModal:N},data:function(){return{columns:j,search:{productId:void 0,status:void 0,teacherId:void 0,type:void 0,keywords:""},classStatusList:$,classTypeList:F,multiClassList:[],productList:[],teacher:[],getListLoading:!1,paging:{total:0,offset:0,pageSize:10},copyModalVisible:!1,copyMultiClassId:0,headerTitle:"什么是班课？",headerTip:"班课是以班级形式按照特定的时间安排所进行的课程"}},created:function(){var t=this.$route.params.paging;t&&(this.paging=t),this.getMultiClassList(this.paging),this.getMultiClassProductList(),this.getTeacherList()},methods:{goToCreateMultiClassPage:function(t){this.$router.push({name:t})},getTeacherList:function(){var t=this;return x()(V().mark((function e(){var r,n;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.G.search({offset:0,limit:1e5});case 2:r=e.sent,n=r.data,t.teacher=n;case 5:case"end":return e.stop()}}),e)})))()},getMultiClassProductList:function(){var t=this;return x()(V().mark((function e(){var r,n,a,i;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.x.search({keywords:"",offset:0,limit:1e5});case 2:r=e.sent,n=r.data,t.productList=n,a=_.findIndex(t.columns,(function(t){return"product"===t.dataIndex})),(i=t.columns[a]).filters=[],_.forEach(n,(function(t){i.filters.push({text:t.title,value:t.id})})),t.$set(t.columns,a,i);case 10:case"end":return e.stop()}}),e)})))()},getMultiClassList:function(){var t=arguments,e=this;return x()(V().mark((function r(){var n,a,i,o;return V().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return(n=t.length>0&&void 0!==t[0]?t[0]:{}).limit=n.pageSize||10,n.offset=n.offset||0,n.keywords=n.keywords||"",e.getListLoading=!0,r.prev=5,r.next=8,k.u.search(n);case 8:a=r.sent,i=a.data,(o=a.paging).page=o.offset/o.limit+1,o.pageSize=Number(o.limit),o.current=n.current||1,e.multiClassList=i,e.paging=o;case 16:return r.prev=16,e.getListLoading=!1,r.finish(16);case 19:case"end":return r.stop()}}),r,null,[[5,,16,19]])})))()},searchMultiClass:function(){this.getMultiClassList(this.search)},deleteMultiClass:function(t){var e,r=this;this.$confirm({content:"确认要删除该班课？",okType:"danger",maskClosable:!0,icon:"close-circle",onOk:(e=x()(V().mark((function e(){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.u.delete({id:t.id});case 2:e.sent.success&&(r.$message.success("删除成功"),r.getMultiClassList());case 5:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})})},goToMultiClassManage:function(t){this.$router.push({name:"MultiClassCourseManage",params:{id:t}})},change:function(t,e,r){var n={productId:this.search.productId,status:this.search.status,teacherId:this.search.teacherId,type:this.search.type};t&&(n.offset=t.pageSize*(t.current-1),n.pageSize=t.pageSize,n.current=t.current),e&&y()(e).length>0&&_.forEach(y()(e),(function(t){n[t]=e[t]})),r&&r.order&&(n["".concat(r.field,"Sort")]="ascend"===r.order?"ASC":"DESC"),y()(n).length>0&&this.getMultiClassList(n)},copyMultiClass:function(t){this.copyModalVisible=!0,this.copyMultiClassId=t.id},eventCommunication:function(t){"cancel-modal"===t.event&&(this.copyModalVisible=!1)},goToEditorMultiClass:function(t,e){this.$router.push({name:{normal:"MultiClassCreate",group:"MultiClassCreateGroup"}[e],query:{id:t},params:{paging:this.paging}})},handleChange:function(){console.log(this.search)},filterOption:function(t,e){return e.componentOptions.children[0].text.toLowerCase().indexOf(t.toLowerCase())>=0}}},G=z,O=Object(I.a)(G,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("aside-layout",{attrs:{breadcrumbs:[{name:"班课列表"}],headerTip:t.headerTip,headerTitle:t.headerTitle}},[r("a-spin",{attrs:{spinning:t.getListLoading}},[r("div",{staticClass:"clearfix cd-mb16"},[r("a-select",{staticStyle:{width:"150px"},attrs:{"show-search":"",allowClear:"",notFoundContent:"暂无数据",placeholder:"所属产品筛选","option-filter-prop":"children","filter-option":t.filterOption},on:{change:t.handleChange},model:{value:t.search.productId,callback:function(e){t.$set(t.search,"productId",e)},expression:"search.productId"}},t._l(t.productList,(function(e){return r("a-select-option",{key:e.id},[t._v("\n           "+t._s(e.title)+"\n       ")])})),1),t._v(" "),r("a-select",{staticStyle:{width:"120px"},attrs:{allowClear:"",placeholder:"班课状态"},on:{change:t.handleChange},model:{value:t.search.status,callback:function(e){t.$set(t.search,"status",e)},expression:"search.status"}},t._l(t.classStatusList,(function(e){return r("a-select-option",{key:e.status},[t._v("\n           "+t._s(e.name)+"\n       ")])})),1),t._v(" "),r("a-select",{staticStyle:{width:"150px"},attrs:{"show-search":"",allowClear:"",notFoundContent:"暂无数据",placeholder:"授课老师","option-filter-prop":"children","filter-option":t.filterOption},on:{change:t.handleChange},model:{value:t.search.teacherId,callback:function(e){t.$set(t.search,"teacherId",e)},expression:"search.teacherId"}},t._l(t.teacher,(function(e){return r("a-select-option",{key:e.id},[t._v("\n           "+t._s(e.nickname)+"\n       ")])})),1),t._v(" "),r("a-select",{staticStyle:{width:"120px"},attrs:{allowClear:"",placeholder:"班课类型"},on:{change:t.handleChange},model:{value:t.search.type,callback:function(e){t.$set(t.search,"type",e)},expression:"search.type"}},t._l(t.classTypeList,(function(e){return r("a-select-option",{key:e.status},[t._v("\n           "+t._s(e.name)+"\n       ")])})),1),t._v(" "),r("a-input",{staticStyle:{width:"224px"},attrs:{placeholder:"请输入班课名称",allowClear:!0},on:{search:t.searchMultiClass,pressEnter:t.searchMultiClass},model:{value:t.search.keywords,callback:function(e){t.$set(t.search,"keywords",e)},expression:"search.keywords"}}),t._v(" "),r("a-button",{attrs:{type:"primary"},on:{click:t.searchMultiClass}},[t._v("搜索")]),t._v(" "),r("a-dropdown",[r("a-button",{staticClass:"pull-right",attrs:{type:"primary"}},[t._v("新建班课")]),t._v(" "),r("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[r("a-menu-item",[r("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.goToCreateMultiClassPage("MultiClassCreate")}}},[t._v("大班课")])]),t._v(" "),r("a-menu-item",[r("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.goToCreateMultiClassPage("MultiClassCreateGroup")}}},[t._v("分组大班课")])])],1)],1)],1),t._v(" "),r("a-table",{attrs:{columns:t.columns,pagination:t.paging,"data-source":t.multiClassList,scroll:{x:2e3},rowKey:function(t){return t.id}},on:{change:t.change},scopedSlots:t._u([{key:"class_title",fn:function(e,n){return r("a",{attrs:{href:"javascript:;",title:e},on:{click:function(e){return t.goToMultiClassManage(n.id)}}},[t._v("\n       "+t._s(e)+"\n     ")])}},{key:"taskNum",fn:function(e,n){return r("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.goToMultiClassManage(n.id)}}},[t._v("\n       "+t._s(n.endTaskNum)+"/"+t._s(n.taskNum)+"\n     ")])}},{key:"course",fn:function(e){return r("a",{attrs:{href:"/course/"+e.id,target:"_blank",title:e.courseSetTitle}},[t._v("\n       "+t._s(e.courseSetTitle)+"\n     ")])}},{key:"type",fn:function(e){return[r("span",[t._v(t._s("normal"===e?"大班课":"分组大班课"))])]}},{key:"status",fn:function(e){return["notStart"===e?r("span",{staticStyle:{"font-size":"14px",color:"#fb8d4d"}},[t._v("未开课")]):"living"===e?r("span",{staticStyle:{"font-size":"14px",color:"#43bc60"}},[t._v("开课中")]):r("span",{staticStyle:{"font-size":"14px",color:"#999"}},[t._v("已结课")])]}},{key:"assistant",fn:function(t){return r("assistant",{attrs:{assistant:t}})}},{key:"studentNum",fn:function(e,n){return r("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.$router.push({name:"MultiClassStudentManage",params:{id:n.id}})}}},[t._v("\n       "+t._s(e)+"\n     ")])}},{key:"createdTime",fn:function(e){return[t._v("\n       "+t._s(t.$dateFormat(e,"YYYY-MM-DD HH:mm"))+"\n     ")]}},{key:"action",fn:function(e,n){return[r("a-button",{attrs:{type:"link"},on:{click:function(e){return t.goToMultiClassManage(n.id)}}},[t._v("管理")]),t._v(" "),r("a-button",{attrs:{type:"link"},on:{click:function(e){return t.goToEditorMultiClass(n.id,n.type)}}},[t._v("编辑")]),t._v(" "),r("a-dropdown",[r("a",{staticClass:"ant-dropdown-link",staticStyle:{"margin-left":"-6px"},on:{click:function(t){return t.preventDefault()}}},[r("a-icon",{attrs:{type:"caret-down"}})],1),t._v(" "),r("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[r("a-menu-item",[r("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.copyMultiClass(n)}}},[t._v("复制班课")])]),t._v(" "),r("a-menu-item",[r("a",{staticClass:"color-danger",attrs:{href:"javascript:;"},on:{click:function(e){return t.deleteMultiClass(n)}}},[t._v("删除")])])],1)],1),t._v(" "),r("a-button",{attrs:{type:"link"},on:{click:function(e){return t.$router.push({name:"MultiClassDataPreview",params:{id:n.id}})}}},[t._v("数据概览")])]}}])})],1),t._v(" "),r("copy-multi-class-modal",{attrs:{id:t.copyMultiClassId,visible:t.copyModalVisible},on:{"event-communication":t.eventCommunication}})],1)}),[],!1,null,null,null);e.default=O.exports},1652:function(t,e,r){},1653:function(t,e,r){"use strict";var n={name:"AsideLayout",props:{breadcrumbs:{type:Array,required:!0},headerTitle:{type:String,default:""},headerTip:{type:String,default:""},titleTip:{type:String,default:""}}},a=(r(1654),r(22)),i=Object(a.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"aside-layout"},[r("div",{staticClass:"aside-layout-header"},[r("a-breadcrumb",{staticClass:"pull-left aside-layout-header__breadcrumb",attrs:{separator:"/"}},t._l(t.breadcrumbs,(function(e,n){return r("a-breadcrumb-item",{key:n},[e.href?[r("a",{attrs:{href:e.href,target:"_blank"}},[t._v(t._s(e.name))])]:e.pathName?[r("a",{attrs:{href:"javascript:;"},on:{click:function(r){return t.$router.push({name:e.pathName})}}},[t._v(t._s(e.name))])]:[t._v("\n          "+t._s(e.name)+"\n        ")]],2)})),1),t._v(" "),t.headerTip?r("a-popover",{attrs:{placement:"bottomLeft"}},[r("template",{slot:"content"},[r("div",{staticClass:"aside-header-tip",domProps:{innerHTML:t._s(t.headerTip)}})]),t._v(" "),r("span",{staticClass:"aside-header-title-icon"},[r("a-icon",{attrs:{theme:"filled",type:"question-circle"}}),r("span",{staticClass:"icon-circle"},[t._v(t._s(t.headerTitle))])],1)],2):t._e(),t._v(" "),t.titleTip?r("span",{staticClass:"aside-header-title-icon"},[t._v(t._s(t.titleTip))]):t._e()],1),t._v(" "),r("div",{staticClass:"aside-layout-main"},[t._t("default")],2)])}),[],!1,null,null,null);e.a=i.exports},1654:function(t,e,r){"use strict";var n=r(1652);r.n(n).a},1664:function(t,e,r){},1683:function(t,e,r){"use strict";var n=r(1664);r.n(n).a},1692:function(t,e,r){"use strict";var n=r(74),a=r.n(n),i={name:"Assistant",props:{assistant:{required:!0,default:function(){return[]}}},data:function(){return{ellipsis:!1}},computed:{assistants:function(){if(!a.a.size(this.assistant))return"- -";var t=[];return this.assistant.nickname?t.push(this.assistant.nickname):a.a.forEach(this.assistant,(function(e,r){e.nickname?t.push(e.nickname):t.push(e)})),a.a.join(t,"、")}},mounted:function(){var t=this.$refs.assistant;this.ellipsis=t.scrollWidth>t.clientWidth}},o=(r(1683),r(22)),s=Object(o.a)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{ref:"assistant",class:[t.ellipsis?"assistant":"","text-overflow"]},[t._v("\n  "+t._s(t.assistants)+"\n\n  "),t.ellipsis?r("a-tooltip",{staticClass:"assistant-all",attrs:{placement:"bottom"}},[r("template",{slot:"title"},[r("span",[t._v(t._s(t.assistants))])]),t._v(" "),r("svg-icon",{staticStyle:{color:"#979797"},attrs:{icon:"icon-more"}})],2):t._e()],1)}),[],!1,null,"18dadfc4",null);e.a=s.exports},381:function(t,e,r){t.exports=r(668)},4:function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},5:function(t,e,r){var n=r(20);function a(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),n(t,a.key,a)}}t.exports=function(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),t}},50:function(t,e,r){t.exports=r(670)},668:function(t,e,r){r(669),t.exports=r(67).Reflect.deleteProperty},669:function(t,e,r){var n=r(82),a=r(280).f,i=r(140);n(n.S,"Reflect",{deleteProperty:function(t,e){var r=a(i(t),e);return!(r&&!r.configurable)&&delete t[e]}})},670:function(t,e,r){r(671),t.exports=r(67).Object.keys},671:function(t,e,r){var n=r(255),a=r(281);r(427)("keys",(function(){return function(t){return a(n(t))}}))}}]);