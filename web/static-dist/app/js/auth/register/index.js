!function(e){function t(t){for(var a,l,o=t[0],s=t[1],m=t[2],u=0,c=[];u<o.length;u++)l=o[u],Object.prototype.hasOwnProperty.call(r,l)&&r[l]&&c.push(r[l][0]),r[l]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);for(d&&d(t);c.length;)c.shift()();return n.push.apply(n,m||[]),i()}function i(){for(var e,t=0;t<n.length;t++){for(var i=n[t],a=!0,o=1;o<i.length;o++){var s=i[o];0!==r[s]&&(a=!1)}a&&(n.splice(t--,1),e=l(l.s=i[0]))}return e}var a={},r={161:0},n=[];function l(t){if(a[t])return a[t].exports;var i=a[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,l),i.l=!0,i.exports}l.m=e,l.c=a,l.d=function(e,t,i){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(l.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)l.d(i,a,function(t){return e[t]}.bind(null,a));return i},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/static-dist/";var o=window.webpackJsonp=window.webpackJsonp||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var m=0;m<o.length;m++)t(o[m]);var d=s;n.push([1570,0]),i()}({1570:function(e,t,i){"use strict";i.r(t);var a=i(20),r=i.n(a),n=i(103),l=i.n(n),o=i(71),s=i.n(o),m=i(69),d=i.n(m),u=i(72),c=i.n(u),_=i(50),g=i.n(_),p=i(31),b=i.n(p),h=i(4),v=i.n(h),f=i(5),y=i.n(f),k=i(110),C=i(84),w=i(126),T=i(53);function M(e,t){var i=g()(e);if(c.a){var a=c()(e);t&&(a=a.filter((function(t){return d()(e,t).enumerable}))),i.push.apply(i,a)}return i}var j=function(){function e(){v()(this,e),this.drag=$("#drag-btn").length?new C.a($("#drag-btn"),$(".js-jigsaw"),{limitType:"web_register"}):null,this.setValidateRule(),this.dragEvent(),this.initPasswordEyeClickEvent(),this.initValidator(),this.initCodeValidateEvent(),this.initEmailOrMobileEvent(),this.initCodeSendBtn(),this.initFieldVisitId(),this.submitFrom(),this.initRegisterModeSwitch(),this.initEmailMobileMsg()}return y()(e,[{key:"dragEvent",value:function(){var e=this;this.drag&&this.drag.on("success",(function(t){e._codeBtnEnable()}))}},{key:"initPasswordEyeClickEvent",value:function(){$(".open-eye").on("click",(function(){$("#register_password").attr("type","password"),$(".open-eye").hide(),$(".close-eye").show()})),$(".close-eye").on("click",(function(){$("#register_password").attr("type","text"),$(".close-eye").hide(),$(".open-eye").show()}))}},{key:"resetDragCaptchaAndCodeBtn",value:function(){this._codeBtnDisable(),this.drag.initDragCaptcha(),$('input[name="dragCaptchaToken"]').val("")}},{key:"initRegisterModeSwitch",value:function(){var e=this;0!==$("#register_mode_switch").length&&($("#register_mode_switch").text(Translator.trans("auth.register.register_by_email")).attr("mode","mobile"),$("#register_emailOrMobile-label").text(Translator.trans("auth.register.mobile")),$("#register_emailOrMobile-input").attr("placeholder",Translator.trans("auth.register.input_mobile")),$("#register_emailOrMobile-label").attr("for","verifiedMobile"),$("#register_emailOrMobile-input").attr("name","verifiedMobile"),this._codeBtnDisable(),$("#register_mode_switch").on("click",(function(){e.resetValidation(),e.resetDragCaptchaAndCodeBtn(),$("#register_emailOrMobile-input").val(""),"email"===$("#register_mode_switch").attr("mode")?($("#register_mode_switch").text(Translator.trans("auth.register.register_by_email")).attr("mode","mobile"),$("#register_emailOrMobile-label").text(Translator.trans("auth.register.mobile")),$("#register_emailOrMobile-input").attr("placeholder",Translator.trans("auth.register.input_mobile")),$("#register_emailOrMobile-label").attr("for","verifiedMobile"),$("#register_emailOrMobile-input").attr("name","verifiedMobile"),$("#register_emailOrMobile-input").attr("type","tel")):"mobile"===$("#register_mode_switch").attr("mode")&&($("#register_mode_switch").text(Translator.trans("auth.register.register_by_mobile")).attr("mode","email"),$("#register_emailOrMobile-label").text(Translator.trans("auth.register.email")),$("#register_emailOrMobile-input").attr("placeholder",Translator.trans("auth.register.input_email")),$("#register_emailOrMobile-label").attr("for","email"),$("#register_emailOrMobile-input").attr("name","email"),$("#register_emailOrMobile-input").attr("type","email")),e.initEmailMobileMsg()})))}},{key:"resetValidation",value:function(){$("#register-form").validate().resetForm(),$(".error").removeClass("error"),$(".error-message").remove(),this._codeBtnDisable()}},{key:"initEmailMobileMsg",value:function(){var e=$('input[name="register_mode"]').val();$(".email_mobile_msg").removeClass("hidden"),$(".js-email_mobile_msg-input").removeClass("hidden"),"email"===e?"opened"===$('input[name="email_enabled"]').val()?($(".js-email_mobile_msg-input").attr("placeholder",Translator.trans("auth.register.input_email_verification_code")),$(".js-email_mobile_msg-input").attr("name","email_code"),$(".js-email_mobile_msg-input").attr("id","email_code"),$(".js-email_mobile_msg-label").text(Translator.trans("auth.register.email_verification_code")),$(".js-email_mobile_msg-label").attr("for","email_code")):$(".email_mobile_msg").addClass("hidden"):"mobile"===e?($(".js-email_mobile_msg-input").attr("placeholder",Translator.trans("auth.register.input_mobile_verification_code")),$(".js-email_mobile_msg-input").attr("name","sms_code"),$(".js-email_mobile_msg-input").attr("id","sms_code"),$(".js-email_mobile_msg-label").text(Translator.trans("auth.register.mobile_verification_code")),$(".js-email_mobile_msg-label").attr("for","sms_code")):"email"===$("#register_mode_switch").attr("mode")&&"opened"===$('input[name="email_enabled"]').val()?($(".js-email_mobile_msg-input").attr("placeholder",Translator.trans("auth.register.input_email_verification_code")),$(".js-email_mobile_msg-input").attr("name","email_code"),$(".js-email_mobile_msg-input").attr("id","email_code"),$(".js-email_mobile_msg-label").text(Translator.trans("auth.register.email_verification_code")),$(".js-email_mobile_msg-label").attr("for","email_code")):"email"===$("#register_mode_switch").attr("mode")&&"closed"===$('input[name="email_enabled"]').val()?$(".email_mobile_msg").addClass("hidden"):"mobile"===$("#register_mode_switch").attr("mode")&&($(".js-email_mobile_msg-input").attr("placeholder",Translator.trans("auth.register.input_mobile_verification_code")),$(".js-email_mobile_msg-input").attr("name","sms_code"),$(".js-email_mobile_msg-input").attr("id","sms_code"),$(".js-email_mobile_msg-label").text(Translator.trans("auth.register.mobile_verification_code")),$(".js-email_mobile_msg-label").attr("for","sms_code"))}},{key:"setValidateRule",value:function(){$.validator.addMethod("spaceNoSupport",(function(e,t){return e.indexOf(" ")<0}),$.validator.format(Translator.trans("validate.have_spaces")))}},{key:"initValidator",value:function(){$("#register-form").validate(function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?M(Object(i),!0).forEach((function(t){b()(e,t,i[t])})):s.a?l()(e,s()(i)):M(Object(i)).forEach((function(t){r()(e,t,d()(i,t))}))}return e}({},this._validateRules()))}},{key:"initCodeValidateEvent",value:function(){var e=this;$("#register_mobile").blur((function(){var t=$("#register_mobile").val();e.smsCodeValidate(t)})),$("#register_email").blur((function(){var t=$("#register_email").val();e.emailCodeValidate(t)}))}},{key:"initEmailOrMobileEvent",value:function(){$("#register_emailOrMobile-input").blur((function(){$('input[name="emailOrMobile"]').val($("#register_emailOrMobile-input").val())}))}},{key:"initDragCaptchaCodeRule",value:function(){$(".js-drag-img").length&&$('[name="dragCaptchaToken"]').rules("add",{required:!0,messages:{required:Translator.trans("auth.register.drag_captcha_tips")}})}},{key:"_codeBtnDisable",value:function(){$(".js-code-send-btn").addClass("disabled").attr("disabled",!0)}},{key:"_codeBtnEnable",value:function(){$(".js-code-send-btn").removeClass("disabled").attr("disabled",!1)}},{key:"initSmsCodeRule",value:function(){$('[name="sms_code"]').rules("add",{required:!0,unsigned_integer:!0,rangelength:[6,6],messages:{rangelength:Translator.trans("validate.sms_code.message")}})}},{key:"initEmailCodeRule",value:function(){$('[name="email_code"]').rules("add",{required:!0,unsigned_integer:!0,rangelength:[6,6],messages:{rangelength:Translator.trans("validate.sms_code.message")}})}},{key:"startCountdown",value:function(e,t){var i=this,a=t,r=e.text();this._codeBtnDisable(),e.text(a+"秒后重新获取");var n=setInterval((function(){--a<=0?(clearInterval(n),i._codeBtnEnable(),e.text(r)):e.text(a+"秒后重新获取")}),1e3)}},{key:"initCodeSendBtn",value:function(){var e=$(".js-code-send-btn"),t=this,i=$('input[name="register_mode"]').val();e.click((function(a){if($('input[name="dragCaptchaToken"]').val()&&($('input[name="verifiedMobile"]').val()||$('input[name="email"]').val()))if(t._codeBtnDisable(),"mobile"===i||$("#register_mode_switch").length>0&&"mobile"===$("#register_mode_switch").attr("mode")){var r=(new w.a).getCoordinate(a,$("meta[name=csrf-token]").attr("content")),n=$('[name="verifiedMobile"]').length?"verifiedMobile":"emailOrMobile";new k.a({element:e,url:$(this).data("smsUrl"),smsType:"sms_registration",dataTo:n,captcha:!0,captchaValidated:!0,captchaNum:"dragCaptchaToken",encryptedPoint:r,preSmsSend:function(){return!0},error:function(e){t.drag.initDragCaptcha()},additionalAction:function(i){return"captchaRequired"===i&&(e.attr("disabled",!0),$(".js-drag-jigsaw").removeClass("hidden"),t.captchEnable=!0,t.drag&&t.drag.initDragCaptcha(),!0)}})}else if("email"===i||$("#register_mode_switch").length>0&&"email"===$("#register_mode_switch").attr("mode")){var l={email:"email"===i?$("#register_email").val():$("#register_emailOrMobile-input").val(),dragCaptchaToken:$('[name="dragCaptchaToken"]').val()};T.a.user.sendEmailCode({data:l}).then((function(i){$('[name="emailToken"]').val(i.emailToken),t.startCountdown(e,120)}))}}))}},{key:"_validateRules",value:function(){var e=this;return{rules:{nickname:{required:!0,byte_minlength:4,byte_maxlength:18,nickname:!0,chinese_alphanumeric:!0,es_remote:{type:"get"}},password:{spaceNoSupport:!0,password_normal:!0},invitedCode:{required:!1,reg_inviteCode:!0,es_remote:{type:"get"}},email:{required:!0,email:!0,es_remote:{type:"get",callback:function(t){t?e._codeBtnEnable():e._codeBtnDisable()}}},verifiedMobile:{required:!0,phone:!0,es_remote:{type:"get",callback:function(t){t?e._codeBtnEnable():e._codeBtnDisable()}}},dragCaptchaToken:{required:!0}},messages:{nickname:{required:Translator.trans("auth.register.nickname_required_error_hit")},verifiedMobile:{required:Translator.trans("validate.phone.message")},email:{required:Translator.trans("validate.valid_email_input.message")},dragCaptchaToken:{required:Translator.trans("auth.register.drag_captcha_tips")},password:{required:Translator.trans("password.hint.normal")}}}}},{key:"smsCodeValidate",value:function(e){/^1\d{10}$/.test(e)?(this.initSmsCodeRule(),$('[name="dragCaptchaToken"]').rules("remove")):(this.initDragCaptchaCodeRule(),$('[name="sms_code"]').rules("remove"))}},{key:"emailCodeValidate",value:function(e){/^([a-zA-Z0-9_.\-+])+@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)?(this.initEmailCodeRule(),$('[name="dragCaptchaToken"]').rules("remove")):(this.initDragCaptchaCodeRule(),$('[name="email_code"]').rules("remove"))}},{key:"initFieldVisitId",value:function(){$(document).ready((function(){"undefined"!==window._VISITOR_ID&&$('[name="registerVisitId"]').val(window._VISITOR_ID)}))}},{key:"submitFrom",value:function(){var e=$("#register-form"),t=$("#modal");$("#register-btn").on("click",(function(){var i=e.validate(),a=$('input[name="agree_policy"]').prop("checked");i.form()&&(a||null==a?e.submit():(t.load("/register/agreement"),t.modal("show"),t.on("click",".js-agree-register",(function(){$('input[name="agree_policy"]').prop("checked",!0),t.modal("hide"),e.submit()})),t.on("click",".js-close-modal",(function(){t.modal("hide")}))))}))}}]),e}();new j},35:function(e,t){e.exports=jQuery}});