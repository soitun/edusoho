(window.webpackJsonp=window.webpackJsonp||[]).push([["order"],{"0d6d":function(e,t,s){var a=s("d3f4"),i=s("67ab").onFreeze;s("5eda")("freeze",(function(e){return function(t){return e&&a(t)?e(i(t)):t}}))},"1e61":function(e,t,s){},"639e":function(e,t,s){"use strict";s("c5f6");var a={name:"ECoupon",mixins:[s("8813").a],props:{showButton:{type:Boolean,default:!0},showSelecet:{type:Boolean,default:!1},coupon:{type:Object,default:function(){return{}}},index:{type:Number,default:-1},active:{type:Number,default:-1}},data:function(){return{}},created:function(){},methods:{onSelect:function(){this.showSelecet&&this.$emit("chooseItem",{index:this.index,itemData:this.coupon})},couponHandle:function(){this.$emit("couponHandle",this.coupon)}}},i=s("a6c2"),r=Object(i.a)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"coupon-container e-coupon",on:{click:e.onSelect}},[s("div",{staticClass:"e-coupon__container clearfix e-coupon-single"},[s("div",{key:e.index,staticClass:"e-coupon__body"},[s("div",{staticClass:"e-coupon__header clearfix"},[s("span",{staticClass:"e-coupon__price",domProps:{innerHTML:e._s(e.priceHtml(e.coupon))}}),s("div",{staticClass:"e-coupon__name"},[s("div",{staticClass:"text-overflow text-14 coupon-name"},[e._v("\n            "+e._s(e.coupon.name||e.$t("e.coupon"))+"\n          ")]),e.coupon.deadlineMode&&"time"!==e.coupon.deadlineMode?e._e():s("span",{staticClass:"text-10"},[e._v(e._s(e.timeExpire(e.coupon.createdTime,e.coupon.deadline)))]),"day"!==e.coupon.deadlineMode||e.coupon.currentUserCoupon?e._e():s("span",{staticClass:"text-10"},[e._v(e._s(e.$t("e.validWithinDayAfterReceiving",{number:e.coupon.fixedDay})))]),"day"===e.coupon.deadlineMode&&e.coupon.currentUserCoupon?s("span",{staticClass:"text-10"},[e._v(e._s(e.timeExpire(e.coupon.createdTime,e.coupon.currentUserCoupon.deadline)))]):e._e()]),e.coupon.currentUserCoupon?s("div",{staticClass:"stamp"}):e._e(),e.showSelecet?s("div",{staticClass:"e-coupon__select-circle"},[s("i",{staticClass:"select-icon",class:e.index===e.active?"h5-icon h5-icon-check":""})]):e._e(),e.showButton&&!e.coupon.currentUserCoupon?s("span",{staticClass:"coupon-button",on:{click:e.couponHandle}},[e._v(e._s(e.$t("e.getCoupons")))]):e._e()]),s("div",{staticClass:"e-coupon__middle"}),s("div",{staticClass:"e-coupon__bottom text-overflow"},[e._v("\n        "+e._s(e.$t("e.availableRange"))+"："+e._s(e.scopeFilter(e.coupon))+"\n      ")])])])])}),[],!1,null,null,null);t.a=r.exports},"7cb2":function(e,t,s){"use strict";var a=s("1e61");s.n(a).a},8807:function(e,t,s){"use strict";s("8e6e");var a=s("bd86"),i=(s("a481"),s("ac6a"),s("456d"),s("7f7f"),s("c5f6"),s("2f62"));function r(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function o(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?r(Object(s),!0).forEach((function(t){Object(a.a)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):r(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var n={props:{type:{type:String,default:"price"},course:{type:Object,default:function(){return{}}},order:{type:Object,default:function(){return{}}}},data:function(){return{isFree:0==this.course.price}},computed:o(o({},Object(i.e)(["courseSettings"])),{},{rate:function(){return parseInt(this.course.publishedTaskNum)?parseInt(this.course.progress.percent):0},showStudent:function(){return!this.courseSettings||Number(this.courseSettings.show_student_num_enabled)}}),filters:{numFilter:function(e){return e?parseFloat(e).toFixed(2):""}},methods:{goToPay:function(){this.$router.replace({path:"/pay",query:{id:this.order.id,source:"order",sn:this.order.sn,targetId:this.order.targetId,targetType:this.order.targetType}})},displayPrice:function(e){var t,s=this.type;if("order"===s){var a=e.currency,i=e.coinAmount,r=e.coinName,o=e.amount;return"coin"===a?(t=i?(i/100).toFixed(2):"",t="".concat(t," ").concat(r)):"RMB"===a&&(t=o?(o/100).toFixed(2):"",t="¥ ".concat(t)),t}if("confirmOrder"===s){var n=e.priceType,c=e.coinPayAmount,l=e.coinName,u=e.totalPrice;return"Coin"===n?(t=c?parseFloat(c).toFixed(2):"",t="".concat(t," ").concat(l)):"RMB"===n&&(t="¥ ".concat(u)),t}}}},c=s("a6c2"),l=Object(c.a)(n,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"e-course-switch-box"},["price"===e.type?s("div",{staticClass:"switch-box"},[s("span",{staticClass:"text-12"},[e.isFree?s("p",{staticClass:"free"},[e._v(e._s(e.$t("e.free")))]):e._e(),e.isFree?e._e():s("p",{staticClass:"price"},[e._v("¥ "+e._s(e.course.price))])]),s("span",{staticClass:"text-12"},[e.showStudent?s("p",[e._v(e._s(e.$t("e.personStudying",{number:e.course.studentNum})))]):e._e()])]):e._e(),"order"===e.type?s("div",{staticClass:"switch-box"},[s("span",{staticClass:"text-12"},[e.isFree?s("p",{staticClass:"free"},[e._v(e._s(e.$t("e.free")))]):e._e(),e.isFree?e._e():s("p",{staticClass:"price"},[e._v("\n        "+e._s(e.displayPrice(e.order.priceConvert))+"\n      ")])]),s("span",{staticClass:"text-12"},["created"!==e.order.status&&"paying"!==e.order.status?s("p",{class:e.order.status},[e._v("\n        "+e._s(e._f("filterOrderStatus")(e.order.status))+"\n      ")]):e._e(),"created"===e.order.status||"paying"===e.order.status?s("span",{staticClass:"order-pay",on:{click:e.goToPay}},[e._v(e._s(e._f("filterOrderStatus")(e.order.status)))]):e._e()])]):e._e(),"confirmOrder"===e.type?s("div",{staticClass:"switch-box"},[s("span",{staticClass:"text-12"},[s("p",{staticClass:"price"},[e._v(e._s(e.displayPrice(e.order)))])])]):e._e(),"rank"===e.type?s("div",{staticClass:"rank-box"},[s("div",{staticClass:"progress round-conner"},[s("div",{staticClass:"curRate round-conner",style:{width:e.rate+"%"}})]),s("span",[e._v(e._s(this.rate)+"%")])]):e._e()])}),[],!1,null,null,null).exports,u=s("a556");function p(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}var d={components:{switchBox:l},props:{course:{type:Object,default:function(){return{}}},order:{type:Object,default:function(){return{}}},classroom:{type:Object,default:function(){return{}}},type:{type:String,default:"price"},feedback:{type:Boolean,default:!0},typeList:{type:String,default:"course_list"},duration:{type:[Number,String],default:0}},data:function(){return{pathName:this.$route.name}},computed:{imgSrc:function(){if("classroom_list"===this.typeList)return this.course.cover.middle;var e=this.course.courseSet;return(e?e.cover.middle:this.order.cover.middle)||""},title:function(){return"classroom_list"===this.typeList?this.course.title:this.course.courseSetTitle||(this.course.courseSet?this.course.courseSet.title:"")||this.order.title},teachPlan:function(){return!!this.course.title&&this.course.title},imgClass:function(){return"vip"===this.typeList?"e-vip__img":"e-course__img"}},watch:{course:{handler:function(e){var t=e.courseSet;if("miniprogramSetting"===this.pathName&&t)for(var s=Object.keys(t.cover),a=0;a<s.length;a++)t.cover[s[a]]=t.cover[s[a]].replace(/^(\/\/)|(http:\/\/)/,"https://")},immediate:!0}},methods:{onClick:function(e){var t,s="order"===this.type;if(!s&&!parseInt(null===(t=this.course)||void 0===t?void 0:t.canLearn))return Object(u.a)("course");if(this.feedback&&"vip"!==this.typeList){var i=this.course.id||this.order.targetId;"SPAN"!==e.target.tagName&&(s?"course"===this.typeList||"classroom"===this.typeList?this.$router.push({path:"/goods/".concat(this.order.goodsId,"/show"),query:{targetId:this.order.targetId,type:this.typeList+"_list"}}):location.href=this.order.targetUrl:"course"!==this.typeList&&("classroom_list"===this.typeList&&this.$router.push({path:"/classroom/".concat(i)}),"course_list"===this.typeList&&this.$router.push({path:"/course/".concat(i),query:function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?p(Object(s),!0).forEach((function(t){Object(a.a)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):p(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},this.course.lastLearnTask?{lastLearnTaskId:this.course.lastLearnTask.id,lastLearnTaskType:this.course.lastLearnTask.type}:{})})))}}}},h=Object(c.a)(d,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"e-course",on:{click:e.onClick}},[s("div",{staticClass:"clearfix"},[s("div",{staticClass:"e-course__left pull-left relative"},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.imgSrc,expression:"imgSrc"}],class:e.imgClass}),"2k"===e.course.videoMaxLevel?s("div",{staticClass:"absolute left-0 bottom-0 px-8 text-white text-12 font-medium bg-black bg-opacity-80",staticStyle:{"padding-top":"2px","padding-bottom":"2px","line-height":"20px","border-top-right-radius":"12px"}},[e._v("2K 优享")]):e._e(),"4k"===e.course.videoMaxLevel?s("div",{staticClass:"absolute left-0 bottom-0 px-8 text-[#492F0B] text-12 font-medium bg-gradient-to-l from-[#F7D27B] to-[#FCEABE]",staticStyle:{"padding-top":"2px","padding-bottom":"2px","line-height":"20px","border-top-right-radius":"12px"}},[e._v("4K 臻享")]):e._e()]),s("div",{staticClass:"e-course__right pull-left"},["confirmOrder"===e.type?s("div",{staticClass:"e-course__title course-confirm-title"},[e._v("\n        "+e._s(e.title)+"\n      ")]):s("div",[s("div",{staticClass:"e-course__title line-clamp-2"},[e._v(e._s(e.title))]),"classroom_list"===e.typeList?s("div",{staticClass:"e-course__count"},[e._v("\n          "+e._s(e.$t("e.totalOfTwoCourses",{number:e.course.courseNum}))+"\n        ")]):e._e(),"course_list"===e.typeList?s("div",{staticClass:"e-course__project"},[e.teachPlan?s("span",{staticClass:"text-overflow",staticStyle:{"max-width":"192px"}},[e._v(e._s(e.teachPlan))]):e._e()]):e._e()]),s("switchBox",{attrs:{type:e.type,course:e.course,order:e.order,"student-num":e.course.studentNum,"published-task-num":e.course.publishedTaskNum}})],1)]),e.course.lastLearnTask?s("div",{staticClass:"e-course-last_learn_task-container"},[s("img",{staticClass:"icon",attrs:{src:"static/images/course/last-learn-task-icon.svg",alt:""}}),s("div",{staticClass:"text"},[e._v(e._s("上次学到：课时"+e.course.lastLearnTask.number+"："+e.course.lastLearnTask.title))])]):e._e()])}),[],!1,null,null,null);t.a=h.exports},"8b8e":function(e,t,s){"use strict";s.r(t),s("8e6e"),s("96cf");var a=s("3b8d"),i=(s("a481"),s("e7e5"),s("d399")),r=(s("ac6a"),s("456d"),s("6762"),s("2fdb"),s("c5f6"),s("bd86")),o=s("2f62"),n=s("639e"),c=s("8807"),l=s("3ce7"),u=s("2095"),p=s("4928"),d=s("2ef0"),h=s.n(d),m={props:{item:{type:Object}},methods:{goItemBankExercise:function(e){this.$router.push({name:"item_bank_exercise",params:{id:e}})}}},f=s("a6c2");function g(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function y(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?g(Object(s),!0).forEach((function(t){Object(r.a)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):g(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var v={components:{OrderItemBank:Object(f.a)(m,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex items-center w-full p-12 rounded-6",staticStyle:{"background-color":"#FAFAFA","border-radius":"6px"},on:{click:function(t){return e.goItemBankExercise(e.item.itemBankExercise.id)}}},[s("img",{staticClass:"mr-8 flex-none",staticStyle:{width:"18px"},attrs:{src:"static/images/itemBankExercise/order-item-bank-icon.png",alt:""}}),s("div",{staticClass:"text-14 w-full font-normal truncate",staticStyle:{color:"#5E6166"}},[e._v(e._s(e.item.itemBankExercise.title))]),s("div",{staticClass:"flex-none whitespace-nowrap ml-24"},["0.00"===e.item.itemBankExercise.price?s("div",{staticClass:"text-16 font-semibold",staticStyle:{color:"#FF7E56"}},[e._v("免费")]):s("div",{staticClass:"flex items-center space-x-8"},[s("div",{staticClass:"text-12 font-normal line-through mt-4",staticStyle:{color:"#FF7E56"}},[e._v(e._s("¥"+e.item.itemBankExercise.price))]),s("div",{staticClass:"text-16 font-semibold",staticStyle:{color:"#FF7E56"}},[e._v("免费")])])])])}),[],!1,null,null,null).exports,eCourse:c.a,coupon:n.a,infoCollection:p.a},mixins:[u.a],data:function(){return{course:{availableCoupons:[],courseSet:{cover:{}}},activeItemIndex:-1,showList:!1,itemData:null,couponNumber:0,preferenceCode:"",targetType:this.$route.query.targetType,targetId:this.$route.params.id,targetUnit:this.$route.params.unit,targetNum:this.$route.params.num,vipOrderType:this.$route.params.type,detail:{},payWay:"",selected:!0,paySettings:{},inWechat:this.isWeixinBrowser(),timeoutId:-1,isShowForm:!1,hasCollectUserInfo:!1,isAgree:!1,purchaseAgreement:{},showPurchaseAgreement:!1,agreementDisabled:!0,bindItemBankList:[],itemBankPopupVisible:!1}},created:function(){"升级"===this.vipOrderType&&(this.targetUnit=void 0,this.targetNum=void 0),this.fetchPurchaseAgreement(),this.confirmOrder(),this.getSettings(),this.getBindItemBank()},computed:y(y({},Object(o.e)(["wechatSwitch","isLoading","couponSwitch"])),{},{total:function(){var e,t=this.course,s=t.priceType,a=t.coinName,i=t.totalPrice;if(this.itemData){var r=this.itemData,o=r.type,n=r.rate;e="minus"===o?Math.max(i-n,0).toFixed(2):i?Number(i*n*.1).toFixed(2):""}else e=i?Number(i).toFixed(2):"";return"Coin"===s?e="".concat(e," ").concat(a):"RMB"===s&&(e="¥ ".concat(e)),e},couponMoney:function(){if(this.itemData){var e="discount"===this.itemData.type,t=this.itemData.rate;return e&&(t=Number(this.course.totalPrice-this.course.totalPrice*this.itemData.rate*.1).toFixed(2)),this.couponNumber=t,t}},couponShow:function(){return 0==this.course.availableCoupons.length?this.$t("order.noCouponsAvailable"):this.couponNumber?parseFloat(this.itemData.rate):this.course.availableCoupons.length+this.$t("order.available")},getValidity:function(){return this.$route.query.expiryScope||this.$t("order.longTermEffective")},validPayWay:function(){return!(this.IsCollectUserInfoType&&!this.isReqUserInfoCollect)&&!(this.needCollectUserInfo&&!this.isRequserInfoCollectForm)&&(this.paySettings.wxpayEnabled||this.paySettings.alipayEnabled&&!this.inWechat&&this.userInfoCollect)},IsCollectUserInfoType:function(){return["course","classroom","vip"].includes(this.targetType)},showCollectEntry:function(){return Object.keys(this.userInfoCollectForm).length>0}}),filters:{filterPrice:function(e){return parseFloat(e).toFixed(2)},couponType:function(e){return"discount"==e?"折":"元"}},watch:{},beforeRouteLeave:function(e,t,s){clearTimeout(this.timeoutId),s()},methods:{shouldCollectUserInfo:function(){this.isAgree||1!=this.purchaseAgreement.enabled?this.IsCollectUserInfoType&&!this.hasCollectUserInfo&&this.hasUserInfoCollectForm?Object(i.a)("请先提交信息后再提交订单"):this.handleSubmit():Object(i.a)("请先勾选协议")},showUserInfoCollectForm:function(){this.isShowForm=!0},hideUserInfoCollectForm:function(){this.isShowForm=!1},getInfoCollection:function(){var e=this;i.a.loading({duration:0,message:"加载中...",forbidClick:!0});var t={action:"buy_before",targetType:this.targetType,targetId:this.targetId};this.getInfoCollectionEvent(t).then((function(t){if(Object.keys(t).length)return e.needCollectUserInfo=!0,void e.getInfoCollectionForm(t.id).then((function(){i.a.clear()}));i.a.clear()}))},submitForm:function(){this.hideUserInfoCollectForm(),this.hasCollectUserInfo=!0},handleSubmit:function(){if(0==this.total)this.createOrder("free");else{if(!this.validPayWay)return void i.a.fail("无可用支付方式");this.createOrder("pay")}},usePreferenceCode:function(){var e=this,t=this;l.a.exchangePreferential({query:{code:this.preferenceCode},data:{targetType:this.targetType,targetId:this.targetId,action:"receive"}}).then((function(s){if(s.success){t.itemData=s.data;var a=t.course.availableCoupons.length||0;t.$set(e.course.availableCoupons,a,s.data),t.preferenceCode="",t.showList=!1}else s.error&&i.a.fail(s.error.message)})).catch((function(e){console.log(e)}))},disuse:function(){this.showList=!1,this.activeItemIndex=-1,this.itemData=null,this.couponNumber=0},chooseItem:function(e){this.activeItemIndex=e.index,this.itemData=e.itemData,this.showList=!1},confirmOrder:function(){var e=this,t={targetType:this.targetType,targetId:this.targetId,num:this.targetNum,unit:this.targetUnit,platform:"h5",platform_version:this.$version};l.a.confirmOrder({data:t}).then((function(t){if(e.course=t,e.couponSwitch){var s=t.availableCoupons;e.itemData=s.length>0?s[0]:null}e.IsCollectUserInfoType&&e.getInfoCollection()})).catch((function(t){e.$toast(t.message),setTimeout((function(){e.$router.go(-1)}),2e3)}))},routerChange:function(){var e=this;this.wechatSwitch?this.$router.replace({path:"/pay_success",query:{targetType:this.targetType,targetId:this.targetId}}):"vip"===this.targetType?this.$router.replace({path:"/".concat(this.targetType)},(function(){e.$router.go(-1)})):this.$router.replace({path:"/".concat(this.targetType,"/").concat(this.targetId)},(function(){e.$router.go(-1)}))},getSettings:function(){var e=this;return Object(a.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.a.getSettings({query:{type:"payment"}}).catch((function(e){i.a.fail(e.message)}));case 2:e.paySettings=t.sent,e.paySettings.alipayEnabled&&!e.inWechat?e.payWay="Alipay_LegacyH5":e.paySettings.wxpayEnabled&&(e.payWay="WechatPay_H5");case 4:case"end":return t.stop()}}),t)})))()},createOrder:function(e){var t=this,s=this;l.a.createOrder({data:{targetType:this.targetType,targetId:this.targetId,isOrderCreate:1,couponCode:this.itemData?this.itemData.code:"",unit:this.targetUnit,num:this.targetNum,platform:"h5",platform_version:this.$version}}).then((function(a){"free"==e?s.routerChange():"pay"==e&&(t.detail=Object.assign({},a),s.handlePay())})).catch((function(e){i.a.fail(e.message)}))},isWeixinBrowser:function(){return/micromessenger/.test(navigator.userAgent.toLowerCase())},getTradeInfo:function(e){var t=this;return l.a.getTrade({query:{tradesSn:e}}).then((function(s){s.isPaid?window.location.href=s.paidSuccessUrlH5:t.timeoutId=setTimeout((function(){t.getTradeInfo(e)}),2e3)})).catch((function(e){i.a.fail(e.message)}))},handlePay:function(){var e=this;if(this.validPayWay)if("WechatPay_H5"===this.payWay&&this.inWechat)window.location.href="".concat(window.location.origin,"/pay/center/wxpay_h5?pay_amount=")+"".concat(this.detail.pay_amount,"&title=").concat(this.detail.title,"&sn=").concat(this.detail.sn,"&targetType=").concat(this.targetType,"&targetId=").concat(this.targetId,"&payWay=").concat(this.payWay);else{var t=window.location.origin+window.location.pathname+"#/pay_center?targetType=".concat(this.targetType,"&targetId=").concat(this.targetId,"&payWay=").concat(this.payWay);l.a.createTrade({data:{gateway:this.payWay,type:"purchase",orderSn:this.detail.sn,app_pay:"Y",success_url:t}}).then((function(t){"WechatPay_H5"!==e.payWay?window.location.href=t.payUrl:e.getTradeInfo(t.tradeSn).then((function(){window.location.href=t.mwebUrl}))})).catch((function(e){i.a.fail(e.message)}))}},fetchPurchaseAgreement:function(){var e=this;l.a.getPurchaseAgreement().then((function(t){e.purchaseAgreement=t,1==t.open&&(e.showPurchaseAgreement=!0,e.initAgreeContinueDisabled()),e.agreementDisabled=!1}))},handleClickAgree:function(){this.isAgree?this.isAgree=!1:0==this.purchaseAgreement.open?this.isAgree=!this.isAgree:this.showPurchaseAgreement=!0},handleClickViewAgreement:function(){this.showPurchaseAgreement=!0},handleClickAgreeContinue:function(){this.isAgree=!0,this.showPurchaseAgreement=!1},initAgreeContinueDisabled:function(){var e=this;this.$nextTick((function(){var t=e.$refs.agreement,s=t.offsetHeight,a=t.scrollHeight;if(!(a<=s)){e.agreementDisabled=!0;var i=a-s;e.throttledScrollHandler=h.a.debounce((function(){e.handleScroll(t,i)}),100),t.addEventListener("scroll",e.throttledScrollHandler)}}))},handleScroll:function(e,t){t-e.scrollTop<=60?(e.removeEventListener("scroll",this.throttledScrollHandler),this.agreementDisabled=!1):this.agreementDisabled=!0},getBindItemBank:function(){var e=this;return Object(a.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.a.getBindItemBank({params:{bindType:e.targetType,bindId:e.targetId}});case 2:e.bindItemBankList=t.sent;case 3:case"end":return t.stop()}}),t)})))()}}},_=(s("7cb2"),Object(f.a)(v,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"order"},[s("div",{staticClass:"goods-info"},[e.isLoading?s("e-loading"):e._e(),Object.keys(e.course).length>0?s("e-course",{attrs:{"type-list":e.targetType,duration:e.course.duration,order:e.course,course:e.course,type:"confirmOrder"}}):e._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:e.couponSwitch,expression:"couponSwitch"}],staticClass:"order-coupon"},[s("div",{staticClass:"coupon-column",on:{click:function(t){e.showList=!0}}},[s("span",[e._v(e._s(e.$t("order.coupon")))]),s("span",{class:["red",e.itemData?"coupon-money":""]},[e._v(e._s(e.couponShow)),e.itemData?s("span",{staticClass:"coupon-type"},[e._v(e._s(e._f("couponType")(e.itemData.type)))]):e._e(),s("i",{staticClass:"iconfont icon-arrow-right"})])]),s("van-popup",{staticClass:"e-popup full-height-popup coupon-popup",attrs:{overlay:!1,position:"bottom"},model:{value:e.showList,callback:function(t){e.showList=t},expression:"showList"}},[s("van-nav-bar",{staticClass:"nav-bar",attrs:{"left-arrow":!0,title:e.$t("order.coupon")},on:{"click-left":e.disuse}}),s("div",{class:["btn-coupon-exit",{active:e.activeItemIndex<0}],on:{click:e.disuse}},[e._v("\n          "+e._s(e.$t("order.doNotUseDiscount"))+" "),s("i",{staticClass:"iconfont icon-About"})]),s("div",{staticClass:"e-popup__content coupon-popup__content"},[s("div",{staticClass:"coupon-number-change"},[s("van-field",{attrs:{center:"",border:"",clearable:"",placeholder:e.$t("order.couponCode")},model:{value:e.preferenceCode,callback:function(t){e.preferenceCode=t},expression:"preferenceCode"}},[s("van-button",{attrs:{slot:"button",disabled:!e.preferenceCode,size:"small",type:"primary"},on:{click:e.usePreferenceCode},slot:"button"},[e._v(e._s(e.$t("order.use")))])],1)],1),e._l(e.course.availableCoupons,(function(t,a){return s("coupon",{key:a,attrs:{coupon:t,index:a,active:e.activeItemIndex,"show-button":!1,"show-selecet":!0},on:{chooseItem:e.chooseItem}})})),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.course.availableCoupons.length,expression:"!course.availableCoupons.length"}],staticClass:"coupon-empty"},[s("img",{staticClass:"empty-img",attrs:{src:"static/images/coupon_empty.png"}}),s("div",{staticClass:"empty-text"},[e._v(e._s(e.$t("order.noCoupons")))])])],2)],1)],1),"vip"!==e.targetType?s("div",{staticClass:"order-goods-item"},[s("span",[e._v(e._s(e.$t("order.validity")))]),s("span",{staticClass:"gray-dark",domProps:{innerHTML:e._s(e.getValidity)}})]):e._e(),s("div",{staticClass:"flex flex-col space-y-12 py-20",staticStyle:{"margin-left":"5.33333vw","margin-right":"5.33333vw","border-top":"1px solid #eee"}},[s("div",{staticClass:"flex justify-between"},[s("div",{staticClass:"font-normal",staticStyle:{color:"#9ba5b0","font-size":"3.73333vw"}},[e._v("赠送题库")]),e.bindItemBankList.length>2?s("div",{staticClass:"flex items-center font-normal",staticStyle:{color:"#9ba5b0","font-weight":"400","font-size":"3.73333vw"},on:{click:function(t){e.itemBankPopupVisible=!0}}},[s("div",{},[e._v(e._s("查看全部（"+e.bindItemBankList.length+"）"))]),s("van-icon",{attrs:{name:"arrow"}})],1):e._e()]),0===e.bindItemBankList.length?s("div",[s("div",{staticClass:"goods-info__title",staticStyle:{color:"#919399","font-weight":"400"}},[e._v("暂无题库")])]):s("div",{staticClass:"space-y-12"},[s("order-item-bank",{attrs:{item:e.bindItemBankList[0]}}),e.bindItemBankList.length>1?s("order-item-bank",{attrs:{item:e.bindItemBankList[1]}}):e._e()],1)]),s("van-popup",{style:{height:"80%"},attrs:{round:"",position:"bottom"},on:{close:function(t){e.itemBankPopupVisible=!1}},model:{value:e.itemBankPopupVisible,callback:function(t){e.itemBankPopupVisible=t},expression:"itemBankPopupVisible"}},[s("div",{staticClass:"fixed w-full left-0 flex items-center justify-between p-16",staticStyle:{"background-color":"#fff","border-top-left-radius":"16px","border-top-right-radius":"16px"}},[s("van-icon",{staticClass:"opacity-0",attrs:{name:"cross"}}),s("div",{staticClass:"text-16 font-normal",staticStyle:{color:"#37393D"}},[e._v("赠送题库")]),s("van-icon",{attrs:{name:"cross"},on:{click:function(t){e.itemBankPopupVisible=!1}}})],1),s("div",{staticClass:"flex flex-col",staticStyle:{"margin-top":"56px"}},e._l(e.bindItemBankList,(function(e){return s("div",{key:e.id,staticClass:"flex flex-col px-16 mb-12"},[s("order-item-bank",{attrs:{item:e}})],1)})),0)])],1),e.showCollectEntry?s("div",{staticClass:"personal-info",on:{click:e.showUserInfoCollectForm}},[e._v("\n    "+e._s(e.userInfoCollectForm.formTitle)+"\n    "),s("i",{staticClass:"iconfont icon-arrow-right"})]):e._e(),s("van-popup",{staticClass:"e-popup full-height-popup coupon-popup mt0",attrs:{overlay:!1,position:"bottom"},model:{value:e.isShowForm,callback:function(t){e.isShowForm=t},expression:"isShowForm"}},[s("van-nav-bar",{staticClass:"nav-bar",attrs:{"left-arrow":!0,title:this.userInfoCollectForm.formTitle},on:{"click-left":e.hideUserInfoCollectForm}}),s("info-collection",{attrs:{userInfoCollectForm:this.userInfoCollectForm,formRule:this.userInfoCollectForm.items},on:{submitForm:e.submitForm}})],1),s("div",{staticClass:"payPage"},[e.isLoading?s("e-loading"):e._e(),s("div",{staticClass:"payPage__order"},[s("div",{staticClass:"order__head"},[e._v("\n        "+e._s(e.$t("order.paymentWay"))+"\n      ")]),s("div",{staticClass:"order__infomation"},[s("div",{staticClass:"payWay"},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.paySettings.alipayEnabled&&!e.inWechat,expression:"paySettings.alipayEnabled && !inWechat"}],class:["payWay__item",{"payWay__item--selected":"Alipay_LegacyH5"===e.payWay}],on:{click:function(t){e.payWay="Alipay_LegacyH5",e.selected=!0}}},[s("img",{staticClass:"correct",attrs:{src:"static/images/correct.png"}}),s("div",{staticClass:"right"}),s("img",{staticClass:"payWay__img",attrs:{src:"static/images/zfb.png"}})]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.paySettings.wxpayEnabled,expression:"paySettings.wxpayEnabled"}],class:["payWay__item",{"payWay__item--selected":"WechatPay_H5"===e.payWay}],on:{click:function(t){e.payWay="WechatPay_H5",e.selected=!1}}},[s("img",{staticClass:"correct",attrs:{src:"static/images/correct.png"}}),s("div",{staticClass:"right"}),s("img",{staticClass:"payWay__img",attrs:{src:"static/images/wx.png"}})])])]),1==e.purchaseAgreement.enabled?s("div",{staticClass:"order__agreement"},[s("van-checkbox",{attrs:{value:e.isAgree,"icon-size":"16",shape:"square"},on:{click:e.handleClickAgree}},[e._v("\n          我已阅读并同意"),s("span",{staticClass:"order__agreement__btn",on:{click:function(t){return t.stopPropagation(),e.handleClickViewAgreement(t)}}},[e._v("《"+e._s(e.purchaseAgreement.title)+"》")])])],1):e._e()])],1),s("div",{staticClass:"order-footer"},[s("div",{staticClass:"order-footer__text"},[s("div",[e._v("\n        "+e._s(e.$t("order.pay"))+"："),s("span",{staticClass:"price"},[e._v(e._s(e.total))])]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.itemData,expression:"itemData"}],staticClass:"discount"},[e._v(e._s(e.$t("order.discounted"))+e._s(e.couponMoney))])]),s("div",{class:["order-footer__btn",{disabled:!e.validPayWay}],on:{click:e.shouldCollectUserInfo}},[e._v("\n      "+e._s(e.$t("order.pay2"))+"\n    ")])]),1==e.purchaseAgreement.enabled?s("van-dialog",{staticClass:"purchase-agreement",attrs:{"show-confirm-button":!1},model:{value:e.showPurchaseAgreement,callback:function(t){e.showPurchaseAgreement=t},expression:"showPurchaseAgreement"}},[s("h2",{staticClass:"purchase-agreement__title"},[e._v("《"+e._s(e.purchaseAgreement.title)+"》")]),1!=e.purchaseAgreement.open?s("van-icon",{staticClass:"purchase-agreement__close",attrs:{name:"cross"},on:{click:function(t){e.showPurchaseAgreement=!1}}}):e._e(),s("div",{ref:"agreement",staticClass:"purchase-agreement__content",class:{"purchase-agreement__content--btn":1==e.purchaseAgreement.open},domProps:{innerHTML:e._s(e.purchaseAgreement.content)}}),1==e.purchaseAgreement.open?s("van-button",{staticClass:"purchase-agreement__btn",attrs:{type:"primary",block:"",disabled:e.agreementDisabled},on:{click:e.handleClickAgreeContinue}},[e._v("同意并继续")]):e._e()],1):e._e()],1)}),[],!1,null,"059b0173",null));t.default=_.exports},a556:function(e,t,s){"use strict";s.d(t,"a",(function(){return r})),s("e7e5");var a=s("d399"),i=s("6647"),r=function(e){switch(e){case"course":Object(a.a)(i.a.t("goods.courseClosedToast"));break;case"classroom":Object(a.a)(i.a.t("goods.classroomClosedToast"));break;case"exercise":Object(a.a)(i.a.t("goods.exerciseClosedToast"))}}}}]);