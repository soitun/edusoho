(window.webpackJsonp=window.webpackJsonp||[]).push([["course"],{"07b4":function(t,e,i){"use strict";i("8e6e"),i("ac6a"),i("456d"),i("e7e5");var s=i("d399"),n=i("bd86"),r=i("3ce7"),a=i("2164"),o=i("2f62"),c=i("faa5");function u(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?u(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):u(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var d={name:"finish-dialog",mixins:[a.a],inject:["reload"],data:function(){return{show:!0,path:""}},props:{finishResult:{type:Object,default:function(){return{}}},courseId:{type:String,default:""}},computed:l(l({},Object(o.e)("course",{allTask:function(t){return t.allTask}})),{},{rate:function(){return this.finishResult?"".concat(parseInt(this.finishResult.completionRate),"%"):"0%"},title:function(){return this.finishResult?this.allTask[this.finishResult.result.courseTaskId].title:""}}),created:function(){this.path=this.$route.path},methods:l(l({},Object(o.d)("course",{setSourceType:c.A})),{},{goNextTask:function(){var t=this;if(!this.finishResult.nextTask)return Object(s.a)("没有下一课"),void(this.show=!1);var e={courseId:this.courseId,taskId:this.finishResult.nextTask.id};r.a.getCourseData({query:e}).then((function(e){t.toLearnTask(e)}))},toLearnTask:function(t){if("create"!==t.status){var e={id:t.id};this.$store.commit("course/".concat(c.i),{nextTask:e}),this.showTypeDetail(t),this.show=!1,this.setSourceType({sourceType:"img",taskId:t.id})}else Object(s.a)("课时创建中，敬请期待")},showTypeDetail:function(t){if("published"===t.status)switch(t.type){case"video":this.playVedio(t);break;case"audio":this.playAudio(t);break;case"text":case"ppt":case"doc":this.$router.push({name:"course_web",query:{courseId:this.courseId,taskId:t.id,type:t.type,backUrl:"/course/".concat(this.courseId)}}),this.reload();break;case"live":var e=!1;if(new Date>new Date(1e3*t.endTime)){if(t.activity&&"videoGenerated"===t.activity.replayStatus)return void("self"===t.mediaSource?this.setSourceType({sourceType:"video",taskId:t.id}):this.copyPcUrl(t.courseUrl));if(t.activity&&"ungenerated"===t.activity.replayStatus)return void Object(s.a)("暂无回放");e=!0}this.$router.push({name:"live",query:{courseId:this.courseId,taskId:t.id,type:t.type,title:t.title,replay:e}});break;case"testpaper":var i=t.activity.testpaperInfo.testpaperId;this.$router.push({name:"testpaperIntro",query:{testId:i,targetId:t.id}});break;case"homework":this.$router.push({name:"homeworkIntro",query:{courseId:this.courseId,taskId:t.id}});break;case"exercise":this.$router.push({name:"exerciseIntro",query:{courseId:this.courseId,taskId:t.id}});break;default:this.copyPcUrl(t.courseUrl)}else Object(s.a)("敬请期待")},playVedio:function(t){if("self"===t.mediaSource){var e="/course/".concat(this.courseId);this.$route.path===e?this.setSourceType({sourceType:"video",taskId:t.id}):this.$router.push({path:e,query:{sourceType:"video",taskId:t.id}})}else this.copyPcUrl(t.courseUrl)},playAudio:function(t){var e="/course/".concat(this.courseId);this.$route.path===e?this.setSourceType({sourceType:"audio",taskId:t.id}):this.$router.push({path:e,query:{sourceType:"audio",taskId:t.id}})},closeFinishDialog:function(){this.show=!1,this.$emit("closeFinishDialog")}})},h=i("a6c2"),p=Object(h.a)(d,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("van-overlay",{attrs:{show:t.show,"z-index":9999}},[i("div",{staticClass:"finish-dialog "},[i("div",{staticClass:"finish-dialog-content clearfix"},[i("div",{staticClass:"finish-dialog-top"},[i("img",{staticClass:"finish-dialog-img",attrs:{src:"static/images/reportDialog.png"}}),i("div",{staticClass:"finish-dialog-top--text"},[t._v(t._s(t.$t("courseLearning.learningCompletion")))])]),i("div",{staticClass:"finish-dialog-close",on:{click:t.closeFinishDialog}},[i("i",{staticClass:"iconfont icon-guanbi"})]),i("div",{staticClass:"progress-bar"},[i("div",{staticClass:"progress-bar__content"},[i("div",{staticClass:"progress-bar__rate",style:{width:t.rate}})]),i("div",{staticClass:"progress-bar__text"},[t._v(t._s(t.rate))])]),i("p",{staticClass:"finish-dialog-text"},[t._v(t._s(t.$t("courseLearning.congratulationsOnCompletion")))]),[i("p",{staticClass:"text-overflow"},[t._v(t._s(t.title))]),i("div",{staticClass:"finish-dialog-btn",on:{click:t.goNextTask}},[t._v(t._s(t.$t("courseLearning.nextLesson")))])]],2)])])}),[],!1,null,null,null);e.a=p.exports},"0b19":function(t,e,i){"use strict";var s=i("b2d4");i.n(s).a},"0d18":function(t,e,i){"use strict";var s=i("3e08");i.n(s).a},"158c":function(t,e,i){},1919:function(t,e,i){},"19d9":function(t,e,i){"use strict";var s=i("f9f2");i.n(s).a},"202a":function(t,e,i){"use strict";i("8e6e"),i("ac6a"),i("456d"),i("e17f");var s=i("2241"),n=(i("a481"),i("4917"),i("e7e5"),i("d399")),r=(i("c5f6"),i("96cf"),i("3b8d")),a=(i("7f7f"),i("6762"),i("2fdb"),i("bd86")),o=i("32e6"),c=i.n(o),u=i("2f62"),l=i("3ce7"),d=i("fd23"),h=i("bced"),p=i("07b4"),f=i("4328"),m=i.n(f),v=i("c8a5"),g={props:{type:{type:String,default:""},isShow:{type:Boolean,default:!1},reportType:{type:String,default:""}},methods:{onKeepLearning:function(t){this.$emit("outFocusMask",t)}}},y=i("a6c2"),b=Object(y.a)(g,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.isShow?i("div",{staticClass:"video-report-mask"},["ineffective_learning"===t.type&&"video"===t.reportType?[i("div",{staticClass:"content"},[t._m(0),i("van-button",{attrs:{color:"#43bc60",size:"small"},on:{click:function(e){return t.onKeepLearning("ineffective_learning")}}},[t._v("\n        继续学习\n      ")])],1)]:t._e(),"kick_previous"===t.type?[i("div",{staticClass:"content"},[t._m(1),i("van-button",{attrs:{color:"#43bc60",size:"small"},on:{click:function(e){return t.onKeepLearning("kick_previous")}}},[t._v("\n        继续学习\n      ")])],1)]:t._e(),"reject_current"===t.type?[t._m(2)]:t._e()],2):t._e()}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tips"},[e("p",{staticClass:"ineffective-learning"},[this._v("学累了可以休息一会 :D")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tips"},[e("p",{staticClass:"kick-each-other"},[this._v("请勿同时多开任务学习")]),e("p",{staticClass:"kick-each-other"},[this._v("不要一心多用哦！")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"content"},[e("div",{staticClass:"tips"},[e("p",{staticClass:"kick-each-other"},[this._v("请勿同时多开任务学习")]),e("p",{staticClass:"kick-each-other"},[this._v("不要一心多用哦！")])])])}],!1,null,null,null).exports,k=(i("28a5"),i("18a0")),C=i.n(k),w=/accept/,_={name:"WechatSubscribe",data:function(){return{templateId:"",isWechatSubscribe:!1,firstGuide:!1,secondGuide:!1,isSubscribe:!1}},mounted:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isWeixin()){e.next=2;break}return e.abrupt("return");case 2:return t.isKeyLocalStorage("WECHAT_SUBSCRIBE_FIRST_GUIDE")||(t.firstGuide=!0),e.next=5,l.a.wechatSubscribe();case 5:if(i=e.sent,i.enable){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,l.a.wechatTemplate();case 11:if(t.templateId=e.sent,t.templateId){e.next=14;break}return e.abrupt("return");case 14:t.$nextTick((function(e){t.initSubscribe()}));case 15:case"end":return e.stop()}}),e)})))()},methods:{initSubscribe:function(){var t=this,e={url:window.location.href.split("#")[0]};l.a.wechatJsSdkConfig({params:e}).then((function(e){C.a.config({debug:!1,appId:e.appId,timestamp:e.timestamp,nonceStr:e.nonceStr,signature:e.signature,jsApiList:e.jsApiList,openTagList:["wx-open-subscribe"]}),C.a.ready((function(){t.isWechatSubscribe=!0}))}))},success:function(t){this.firstGuide=!1;var e=t.detail.subscribeDetails;w.test(e)&&(this.isSubscribe=!0,this.$toast(this.$t("courseLearning.subscriptionSucceeded")))},subError:function(t){console.log("fail",t.detail)},isWeixin:function(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)},isKeyLocalStorage:function(t){return!!localStorage.getItem(t)||(localStorage.setItem(t,!0),!1)}}},x=Object(y.a)(_,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.isWechatSubscribe?i("div",{staticClass:"wechat-subscribe"},[t.firstGuide?i("div",{staticClass:"wechat-subscribe-first-guide"},[t._v("\n    "+t._s(t.$t("courseLearning.pleaseClickSubscribe"))+"\n  ")]):t._e(),i("i",{class:["iconfont",t.isSubscribe?"icon-subscribed":"icon-subscribe"]}),i("wx-open-subscribe",{attrs:{template:t.templateId,id:"subscribe-btn"},on:{success:t.success,error:t.subError}},[i("script",{attrs:{slot:"style",type:"text/wxtag-template"},slot:"style"},[t._v("\n      <style>\n        .subscribe-btn {\n          display: inline-block;\n          min-width: 30px;\n          color: #fff;\n          font-size: 14px;\n        }\n      </style>\n    ")]),i("script",{attrs:{type:"text/wxtag-template"}},[t._v('\n      <span class="subscribe-btn">\n        '+t._s(t.$t("courseLearning.subscribe"))+"\n      </span>\n    ")])])],1):t._e()}),[],!1,null,null,null).exports,T=i("faa5"),I=i("2164"),O=i("6647"),S=i("a556"),j=i("e13e"),L=i("f8b7");function D(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function P(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?D(Object(i),!0).forEach((function(e){Object(a.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):D(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var $={components:{countDown:d.a,tagLink:h.a,finishDialog:p.a,VideoReportMask:b,WechatSubscribe:x,openAppDialog:L.a},mixins:[v.a,I.a],props:{courseSet:{type:Object,default:function(){return{}}},seckillActivities:{type:Object,default:null}},data:function(){return{media:{},isShowVedioIframe:!1,finishCondition:void 0,learnMode:!1,enableFinish:!1,isEncryptionPlus:!1,isCoverOpen:!1,isPlaying:!1,player:null,counting:!0,isEmpty:!1,textContent:null,tagData:{earnings:0,isShow:!1,link:"",className:"course-tag",minDirectRewardRatio:0},timeChangingList:[],bindAgencyRelation:{},finishResult:null,finishDialog:!1,lastWatchTime:0,nowWatchTime:0,activity:{},openAppUrl:"",appShow:!1,watermark:{},lastLearnTime:0,jsPlayer:"",playKey:"",taskResult:null}},inject:["getDetailsContent"],computed:P(P(P({},Object(u.e)(["DrpSwitch","cloudSdkCdn","courseSettings","course"])),Object(u.e)("course",{course:function(t){return t},sourceType:function(t){return t.sourceType},selectedPlanId:function(t){return t.selectedPlanId},taskId:function(t){return t.taskId},details:function(t){return t.details},joinStatus:function(t){return t.joinStatus},user:function(t){var e;return(null===(e=t.joinStatus)||void 0===e?void 0:e.user)||{}},allTask:function(t){return t.allTask},nextStudy:function(t){return t.nextStudy}})),{},{showLearnBtn:function(){return this.joinStatus&&["video","audio","ppt"].includes(this.sourceType)},continueLearningText:function(){var t=this.nextStudy,e=t.nextTask,i=t.progress;return e&&0==i?this.$t("courseLearning.startLearning"):this.$t("courseLearning.continueLearning")},isAppleDevice:function(){var t=navigator.userAgent.toLowerCase();return/iphone|ipad/i.test(t)}}),watch:{taskId:function(t,e){("course"!==this.$route.name||this.joinStatus)&&t>0&&this.initHead()},selectedPlanId:function(t){("course"!==this.$route.name||this.joinStatus)&&t>0&&this.initHead()}},created:function(){this.initHead(),this.showTagLink()},beforeDestroy:function(){this.sign.length>0&&localStorage.setItem("flowSign",this.sign),this.player&&this.player.destory&&this.player.destory(),this.clearComputeWatchTime()},methods:P(P(P(P({},Object(u.c)(["setCloudAddress"])),Object(u.d)("course",{setSourceType:T.A})),Object(u.d)("course",{setSourceType:T.A})),{},{toToast:function(){var t=this.finishCondition;if(t){var e="";if(["time","watchTime"].includes(t.type)){var i=Math.ceil((60*t.data-this.learnedTime)/60);e=i>0?"\n剩余 ".concat(i," 分完成"):"\n恭喜！你已完成该任务"}this.$toast({message:"完成条件：".concat(t.text).concat(e),position:"bottom"})}},initHead:function(){["video","audio","ppt"].includes(this.sourceType)&&(window.scrollTo(0,0),this.joinStatus&&(this.initReport(),this.clearComputeWatchTime(),this.lastWatchTime=0,this.nowWatchTime=0),this.initData())},initReport:function(){this.finishDialog=!1,this.getFinishCondition()},getFinishCondition:function(){var t=this;this.getCourseData(this.selectedPlanId,this.taskId).then((function(e){t.activity=e.activity,t.finishCondition=e.activity&&e.activity.finishCondition,t.taskResult=e.result}))},IsLivePlayback:function(){"live"===this.allTask[this.taskId].type&&"join"===this.finishCondition.type&&this.reprtData({eventName:"finish"})},viewAudioDoc:function(){this.isCoverOpen=!0},hideAudioDoc:function(){this.isCoverOpen=!1},handlePlayer:function(){return this.isPlaying?this.player&&this.player.pause():this.player&&this.player.play()},getParams:function(){return this.joinStatus?{query:{courseId:this.selectedPlanId,taskId:this.taskId},params:{version:"escloud"}}:{query:{courseId:this.selectedPlanId,taskId:this.taskId},params:{preview:1,version:"escloud"}}},initData:function(){this.isShowOutFocusMask=!1,this.sign.length>0&&(localStorage.setItem("flowSign",this.sign),this.sign=""),this.$refs.video&&(this.$refs.video.innerHTML=""),this.enableFinish=!!parseInt(this.details.enableFinish),this.player&&this.player.destory&&this.player.destory(),this.getData()},getData:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.b)();case 2:t.watermark=e.sent,l.a.getMedia(t.getParams()).then(function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(i){var s,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=i.media.resNo,n=i.mediaType,t.media=i.media,t.lastLearnTime=i.lastLearnTime,t.playKey="playback_".concat(t.user.id,"_").concat(i.media.resNo),localStorage.setItem(t.playKey,t.lastLearnTime),t.jsPlayer=i.media.jsPlayer,"0"!==s){e.next=12;break}return e.next=9,l.a.getLocalMediaLive({query:{taskId:t.taskId},params:{hls_encryption:1}});case 9:r=e.sent,delete i.media.resNo,i.media.url=r.mediaUri;case 12:if("audio"!==n){e.next=15;break}return t.formateAudioData(i),e.abrupt("return");case 15:if("video"!==n&&"live"!==n){e.next=18;break}return t.formateVedioData(i),e.abrupt("return");case 18:"ppt"===n&&t.formatePptData(i);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){var i=Number(t.details.id);4040101==e.code&&t.$router.push({name:"login",query:{redirect:"/course/".concat(i)}}),n.a.fail(e.message)}));case 4:case"end":return e.stop()}}),e)})))()},formateAudioData:function(t){var e=t.media;if(e.isFinishConvert){if(!this.handleOnlyLearnOnApp())if(this.isEncryptionPlus=e.isEncryptionPlus,e.isEncryptionPlus)Object(n.a)("该浏览器不支持云视频播放，请下载App");else{this.textContent=e.text;var i={id:"course-detail__head--video",user:this.user,resNo:e.resNo,token:e.token,autoplay:!0,disableDataUpload:!0,watermark:{pos:"top.right",width:30,height:30},rememberLastPos:!0,playlist:e.url,disableFullscreen:!0};this.$store.commit("UPDATE_LOADING_STATUS",!0),this.initPlayer(i)}}else Object(n.a)("课程内容准备中，请稍候查看")},isAndroid:function(){var t=navigator.userAgent;return t.indexOf("Android")>-1||t.indexOf("Adr")>-1},cancel:function(){this.setSourceType({sourceType:"",taskId:""}),this.appShow=!1},handleOnlyLearnOnApp:function(){if(0==this.courseSettings.only_learning_on_APP)return!1;var t=this.course.details,e=t.goodsId,i=t.id,s=window.location,n=s.host,r=s.protocol;return navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?this.openAppUrl="kuozhi://".concat(n,"?courseId=").concat(i,"&goodsId=").concat(e):this.openAppUrl="kuozhi://".concat(n,"?protocol=").concat(r.replace(":",""),"&courseId=").concat(i,"&goodsId=").concat(e),this.appShow=!0,!0},formateVedioData:function(t){var e,i,s,r,a=t.media,o=a.timeLimit,c=a.securityVideoPlayer,u=!this.joinStatus&&Number(this.details.tryLookable);if(a.isFinishConvert){if(!this.handleOnlyLearnOnApp()){if(this.isEncryptionPlus=a.isEncryptionPlus,a.isEncryptionPlus&&c)return Object(n.a)("请在APP学习"),void(this.isShowVedioIframe=!0);if(a.isEncryptionPlus&&!c&&!this.detectBrowserInfo())return Object(n.a)("请在APP学习或使用钉钉/飞书/微信/企业微信内置浏览器打开"),void(this.isShowVedioIframe=!0);var l={id:"course-detail__head--video",user:this.user,initPos:this.lastLearnTime,jsPlayer:this.jsPlayer,autoplay:!0,disableFullscreen:this.isAppleDevice,strictMode:!a.supportMobile,pluck:{timelimit:o},fingerprint:{html:null===(e=t.fingerPrintSetting)||void 0===e?void 0:e.video_fingerprint,duration:100*(null===(i=t.fingerPrintSetting)||void 0===i?void 0:i.video_fingerprint_time)},playbackRates:[.75,1,1.25,1.5,2,3],resNo:a.resNo,disableDataUpload:!0,watermark:{pos:"top.right",width:30,height:30,file:null===(s=t.watermarkSetting)||void 0===s?void 0:s.video_watermark_image},language:Object(O.b)(),token:a.token,rememberLastPos:!0,playlist:a.url};a.isEncryptionPlus&&this.isWechat&&c&&(l.playerType="wasm"),u||delete l.pluck;var d=this.activity,h=d.finishType,p=d.finishData;"end"===h&&"1"==p&&"finish"!==(null===(r=this.taskResult)||void 0===r?void 0:r.status)&&(l.disableProgressBar=!0,l.disableSeek="forward"),this.$store.commit("UPDATE_LOADING_STATUS",!0),this.initPlayer(l)}}else Object(n.a)("课程内容准备中，请稍候查看")},formatePptData:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function i(){var s,n;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(s=t.media,e.isEncryptionPlus=s.isEncryptionPlus,e.cloudSdkCdn){i.next=5;break}return i.next=5,e.setCloudAddress();case 5:n="//".concat(e.cloudSdkCdn,"/js-sdk-v2/sdk-v1.js?")+~~(Date.now()/1e3/60),c()(n,(function(i){if(i)throw i;var n={id:"course-detail__head--video",resNo:s.resNo,token:s.token,source:{type:t.mediaType,args:s}};e.watermark.text&&(n.fingerprint={html:e.watermark.text,color:e.watermark.color,alpha:e.watermark.alpha});var r=new window.QiQiuYun.Player(n);e.player=r,r.on("ready",(function(){e.initReportData(e.selectedPlanId,e.taskId,e.sourceType,e.playKey)})),r.on("pagechanged",(function(t){t.page===t.total&&e.finishCondition&&"end"===e.finishCondition.type&&e.reprtData({eventName:"finish"})}))}));case 7:case"end":return i.stop()}}),i)})))()},initPlayer:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function i(){var n;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(e.cloudSdkCdn){i.next=3;break}return i.next=3,e.setCloudAddress();case 3:n="//".concat(e.cloudSdkCdn,"/js-sdk-v2/sdk-v1.js?")+~~(Date.now()/1e3/60),c()(n,(function(i){if(e.$store.commit("UPDATE_LOADING_STATUS",!1),i)throw i;"zh-cn"!==t.language&&t.language||(t.language="zh-CN"),e.watermark.text&&(t.fingerprint={isFull:!0,html:e.watermark.text,color:e.watermark.color,alpha:e.watermark.alpha});var n=new window.QiQiuYun.Player(t);e.player=n,n.on("unablePlay",(function(){e.$refs.video.innerHTML="",s.a.alert({message:"当前内容不支持该手机浏览器观看，建议您使用Chrome、Safari浏览器观看。"}).then((function(){}))})),n.on("ready",(function(){e.initReportData(e.selectedPlanId,e.taskId,e.sourceType,e.playKey),e.IsLivePlayback()})),n.on("playing",(function(){e.isPlaying=!0,e.clearComputeWatchTime(),e.computeWatchTime()})),n.on("timeupdate",(function(t){var i=t.currentTime,s=t.duration;(e.isCloudVideoPalyer()||e.isCloudAudioPlayer()||parseInt(i)!==parseInt(s))&&localStorage.setItem(e.playKey,i)})),n.on("paused",(function(t){e.isPlaying=!1,e.clearComputeWatchTime(),e.reprtData({eventName:"doing",ContinuousReport:!0})})),n.on("ended",(function(){e.clearComputeWatchTime(),e.finishCondition&&"end"===e.finishCondition.type&&e.reprtData({eventName:"finish"})})),e.isAppleDevice&&n.on("requestFullscreen",(function(t){var e;"video"===(null===(e=t.metas)||void 0===e?void 0:e.type)&&(t.isFullscreen?n.iframe.classList.add("fullscreen"):n.iframe.classList.remove("fullscreen"))}))}));case 5:case"end":return i.stop()}}),i)})))()},isCloudVideoPalyer:function(){return"balloon-cloud-video-player"===this.jsPlayer},isCloudAudioPlayer:function(){return"audio-player"===this.jsPlayer},isWechat:function(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)},detectBrowserInfo:function(){var t=navigator.userAgent.toLowerCase(),e=/micromessenger/i.test(t),i=/wxwork/i.test(t),s=/dingtalk/i.test(t),n=/lark/i.test(t);return!!(e||i||s||n)},expire:function(){this.counting=!1},sellOut:function(){this.isEmpty=!0,this.$emit("goodsEmpty")},showTagLink:function(){this.DrpSwitch?(this.initTagData(),this.getAgencyBindRelation()):this.tagData.isShow=!1},getAgencyBindRelation:function(){var t=this;l.a.getAgencyBindRelation().then((function(e){e.agencyId?(t.bindAgencyRelation=e,t.tagData.isShow=!0):t.tagData.isShow=!1}))},initTagData:function(){var t=this;l.a.getDrpSetting().then((function(e){t.drpSetting=e,t.tagData.minDirectRewardRatio=e.minDirectRewardRatio;var i={type:"course",id:t.details.id,merchant_id:t.drpSetting.merchantId};t.tagData.link=t.drpSetting.distributor_template_url+"?"+m.a.stringify(i);var s=t.drpSetting.minDirectRewardRatio/100*t.details.price;t.tagData.earnings=(Math.floor(100*s)/100).toFixed(2)}))},toLearned:function(){var t=this;this.reprtData({eventName:"finish"}).then((function(e){t.finishResult=e,t.finishDialog=!0}))},computeWatchTime:function(){var t=this;this.intervalWatchTime=setInterval((function(){t.nowWatchTime++}),1e3)},clearComputeWatchTime:function(){clearInterval(this.intervalWatchTime),this.intervalWatchTime=null},closeFinishDialog:function(){this.finishDialog=!1},handleClickContinueLearning:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var i,s,r,a,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDetailsContent();case 2:if("closed"!=(null===(i=t.courseSet)||void 0===i?void 0:i.status)){e.next=4;break}return e.abrupt("return",Object(S.a)("course"));case 4:if(!(null===(s=t.course)||void 0===s||null===(r=s.details)||void 0===r||null===(a=r.learningExpiryDate)||void 0===a?void 0:a.expired)){e.next=6;break}return e.abrupt("return",Object(n.a)(t.$t("learning.expired")));case 6:o=t.nextStudy.nextTask.id,c={courseId:t.selectedPlanId,taskId:o};try{l.a.getCourseData({query:c}).then((function(e){t.toLearnTask(e)}))}catch(t){console.log(t)}case 9:case"end":return e.stop()}}),e)})))()},toLearnTask:function(t){"create"!==t.status?(this.$store.commit("course/".concat(T.i),{nextTask:t}),this.showTypeDetail(t)):Object(n.a)("课时创建中，敬请期待")},showTypeDetail:function(t){if("published"===t.status)switch(t.type){case"video":this.playVedio(t);break;case"audio":this.playAudio(t);break;case"ppt":this.setSourceType({sourceType:"ppt",taskId:t.id});break;case"text":case"doc":this.$router.push({name:"course_web",query:{courseId:this.selectedPlanId,taskId:t.id,type:t.type}});break;case"live":var e=!1;if(new Date>new Date(1e3*t.endTime)){if(t.activity&&"videoGenerated"===t.activity.replayStatus)return void("self"===t.mediaSource?this.setSourceType({sourceType:"video",taskId:t.id}):this.copyPcUrl(t.courseUrl));if(t.activity&&"ungenerated"===t.activity.replayStatus)return void Object(n.a)("暂无回放");e=!0}this.$router.push({name:"live",query:{courseId:this.selectedPlanId,taskId:t.id,type:t.type,title:t.title,replay:e}});break;case"testpaper":var i=t.activity.testpaperInfo.testpaperId;this.$router.push({name:"testpaperIntro",query:{testId:i,targetId:t.id}});break;case"homework":this.$router.push({name:"homeworkIntro",query:{courseId:this.selectedPlanId,taskId:t.id}});break;case"exercise":this.$router.push({name:"exerciseIntro",query:{courseId:this.selectedPlanId,taskId:t.id}});break;default:this.copyPcUrl(t.courseUrl)}else Object(n.a)("敬请期待")},playVedio:function(t){if("self"===t.mediaSource){var e="/course/".concat(this.selectedPlanId);this.$route.path===e?this.setSourceType({sourceType:"video",taskId:t.id}):this.$router.push({path:e,query:{sourceType:"video",taskId:t.id}})}else this.copyPcUrl(t.courseUrl)},playAudio:function(t){var e="/course/".concat(this.selectedPlanId);this.$route.path===e?this.setSourceType({sourceType:"audio",taskId:t.id}):this.$router.push({path:e,query:{sourceType:"audio",taskId:t.id}})}})},E=(i("4ce6"),Object(y.a)($,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"course-detail__head pos-rl",attrs:{id:"course-detail__head"}},[i("video-report-mask",{attrs:{type:t.outFocusMaskType,isShow:t.isShowOutFocusMask,reportType:t.reportType},on:{outFocusMask:t.outFocusMask}}),t.textContent?i("div",{directives:[{name:"show",rawName:"v-show",value:["audio"].includes(t.sourceType)&&!t.isEncryptionPlus&&!t.isCoverOpen,expression:"\n      ['audio'].includes(sourceType) && !isEncryptionPlus && !isCoverOpen\n    "}],staticClass:"course-detail__nav--btn",on:{click:t.viewAudioDoc}},[t._v("\n    "+t._s(t.$t("courseLearning.manuscripts"))+"\n  ")]):t._e(),t.textContent?i("div",{directives:[{name:"show",rawName:"v-show",value:["audio"].includes(t.sourceType)&&!t.isEncryptionPlus,expression:"['audio'].includes(sourceType) && !isEncryptionPlus"}],staticClass:"course-detail__nav--cover web-view",class:{opened:t.isCoverOpen}},[i("div",{staticClass:"media-text",domProps:{innerHTML:t._s(t.textContent)}}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isCoverOpen,expression:"isCoverOpen"}],staticClass:"course-detail__nav--cover-control",on:{click:t.handlePlayer}},[i("i",{staticClass:"iconfont",class:t.isPlaying?"icon-zanting":"icon-bofang"})]),i("div",{staticClass:"course-detail__nav--cover-close-btn",on:{click:t.hideAudioDoc}},[i("i",{staticClass:"van-icon van-icon-arrow van-nav-bar__arrow"})])]):t._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:"img"===t.sourceType||t.finishDialog||t.isShowVedioIframe,expression:"sourceType === 'img' || finishDialog || isShowVedioIframe"}],staticClass:"course-detail__head--img",attrs:{id:"course-detail__head--img"}},[t.courseSet.cover?i("img",{class:{"continue-learning-img":t.nextStudy.nextTask},attrs:{src:t.courseSet.cover.large,alt:""}}):t._e(),t.nextStudy.nextTask?i("div",{staticClass:"continue-learning"},[i("h3",{staticClass:"continue-learning__title"},[t._v(t._s(t.nextStudy.nextTask.title))]),i("div",{staticClass:"continue-learning__btn",on:{click:t.handleClickContinueLearning}},[t._v(t._s(t.continueLearningText))])]):t._e(),t.seckillActivities&&"ongoing"===t.seckillActivities.status&&t.counting&&!t.isEmpty?i("countDown",{attrs:{activity:t.seckillActivities},on:{timesUp:t.expire,sellOut:t.sellOut}}):t._e(),i("div",{staticClass:"wechat-subscribe-box"},[i("wechat-subscribe")],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.isShowOutFocusMask,expression:"!isShowOutFocusMask"}]},[i("div",{directives:[{name:"show",rawName:"v-show",value:["video","audio","ppt"].includes(t.sourceType)&&!t.isShowVedioIframe&&!t.finishDialog,expression:"\n        ['video', 'audio', 'ppt'].includes(sourceType) &&\n        !isShowVedioIframe &&\n        !finishDialog\n      "}],ref:"video",attrs:{id:"course-detail__head--video"}})]),t.showLearnBtn?[t.isFinish?i("div",{staticClass:"course-detail__head--btn course-detail__head--activebtn"},[i("i",{staticClass:"iconfont icon-markdone"}),t._v("\n      "+t._s(t.$t("courseLearning.learned"))+"\n    ")]):t._e(),t.isFinish?t._e():i("div",[t.enableFinish?i("div",{staticClass:"course-detail__head--btn",on:{click:t.toLearned}},[t._v("\n        "+t._s(t.$t("courseLearning.learned"))+"\n      ")]):t._e(),t.enableFinish?t._e():i("div",{staticClass:"course-detail__head--btn",on:{click:t.toToast}},[t._v("\n        "+t._s(t.$t("courseLearning.completionConditions"))+"\n      ")])])]:t._e(),i("tagLink",{attrs:{"tag-data":t.tagData}}),t.finishDialog?i("finishDialog",{attrs:{finishResult:t.finishResult,courseId:t.selectedPlanId},on:{closeFinishDialog:t.closeFinishDialog}}):t._e(),t.appShow?i("open-app-dialog",{attrs:{openAppUrl:t.openAppUrl,courseId:t.course.details.id,goodsId:t.course.details.goodsId},on:{cancel:function(e){return t.cancel()}}}):t._e()],2)}),[],!1,null,null,null));e.a=E.exports},2164:function(t,e,i){"use strict";i("e17f");var s=i("2241");e.a={methods:{copyPcUrl:function(t){var e=this,i="暂不支持此类课程学习，请移步至APP或电脑「".concat(t,"」完成课程。");s.a.alert({title:"暂不支持",message:i,messageAlign:"left",confirmButtonText:"复制链接"}).then((function(){e.$copyText(t).then((function(t){console.log(t)}))}))}}}},2268:function(t,e,i){},"2d42":function(t,e,i){"use strict";var s={name:"e-empty",props:{text:{type:String,default:""}}},n=i("a6c2"),r=Object(n.a)(s,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"e-empty"},[e("img",{staticClass:"e-empty__img",attrs:{src:"static/images/empty.png"}}),e("p",{staticClass:"e-empty__text"},[this._v(this._s(this.text))])])}),[],!1,null,null,null);e.a=r.exports},"32e6":function(t,e){function i(t,e){t.onload=function(){this.onerror=this.onload=null,e(null,t)},t.onerror=function(){this.onerror=this.onload=null,e(new Error("Failed to load "+this.src),t)}}function s(t,e){t.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,e(null,t))}}t.exports=function(t,e,n){var r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("script");"function"==typeof e&&(n=e,e={}),e=e||{},n=n||function(){},a.type=e.type||"text/javascript",a.charset=e.charset||"utf8",a.async=!("async"in e)||!!e.async,a.src=t,e.attrs&&function(t,e){for(var i in e)t.setAttribute(i,e[i])}(a,e.attrs),e.text&&(a.text=""+e.text),("onload"in a?i:s)(a,n),a.onload||i(a,n),r.appendChild(a)}},3359:function(t,e,i){},"39ed":function(t,e,i){"use strict";var s={props:{title:{type:String,default:""},content:{type:String,default:""},isJoin:{type:Boolean,default:!1}}},n=(i("492f"),i("a6c2")),r=Object(n.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"closed-tips"},[i("van-icon",{staticClass:"closed-icon",attrs:{name:"warning-o",color:"#FF7D00"}}),i("div",{staticClass:"ml-8 flex flex-col items-start"},[i("span",{staticClass:"title"},[t._v(t._s(t.title))]),t.isJoin?i("span",{staticClass:"content"},[t._v(t._s(t.content))]):t._e()])],1)}),[],!1,null,"784b42fe",null);e.a=r.exports},"3c5e":function(t,e,i){},"3e08":function(t,e,i){},"3e0e":function(t,e,i){},"492f":function(t,e,i){"use strict";var s=i("1919");i.n(s).a},4980:function(t,e,i){"use strict";var s=i("6efb");i.n(s).a},"4cdf":function(t,e,i){},"4ce6":function(t,e,i){"use strict";var s=i("a37b");i.n(s).a},"63dd":function(t,e,i){"use strict";i("7f7f"),i("4917"),e.a={methods:{initAIAgentSdk:function(t,e,i,s){var n=this,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=new window.AgentSDK({token:t,uiIframeSrc:"".concat(window.location.origin,"/static-dist/libs/agent-web-sdk/ui/index.html"),bottom:i,right:s,draggable:r});return e.workerUrl="".concat(window.location.origin,"/agent_worker"),a.setChatMetadata(e),a.on("clickLink",(function(t){var e=t.match(/\/course\/(\d+)\/task\/(\d+)/);if(e){var i=e[1],s=e[2];"course"!==n.$route.name?(n.$router.push({name:"course",params:{id:i}}),n.$nextTick((function(){document.getElementById(s).click()}))):(a.hideIframe(),document.getElementById(s).click())}else window.open(t,"_blank")})),window.aiAgentSdk=a,a}}}},"6ce0":function(t,e,i){"use strict";var s=i("4cdf");i.n(s).a},"6efb":function(t,e,i){},7659:function(t,e,i){"use strict";var s=i("ccb4");i.n(s).a},"870c":function(t,e,i){"use strict";var s=i("a8ab");i.n(s).a},8789:function(t,e,i){},"8b9a":function(t,e,i){"use strict";var s=i("3c5e");i.n(s).a},a30a:function(t,e,i){"use strict";var s=i("3359");i.n(s).a},a362:function(t,e,i){},a37b:function(t,e,i){},a8ab:function(t,e,i){},b2d4:function(t,e,i){},ba01:function(t,e,i){"use strict";i("28a5");var s={props:{item:{type:Object,required:!0},hidePrice:{type:String,default:"0"}},methods:{integerPart:function(t){return t.split(".")[0]},decimalPart:function(t){return t.split(".")[1]},goItemBankExercise:function(t){this.$router.push({name:"item_bank_exercise",params:{id:t}})}}},n=i("a6c2"),r=Object(n.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"flex border border-[#F2F3F5] border-solid",staticStyle:{"border-radius":"8px"},on:{click:function(e){return t.goItemBankExercise(t.item.itemBankExerciseId)}}},[i("img",{staticClass:"h-96",staticStyle:{"border-top-left-radius":"6px","border-bottom-left-radius":"6px"},attrs:{src:t.item.itemBankExercise.cover.middle,alt:""}}),i("div",{staticClass:"flex flex-col w-full px-12 justify-center"},[i("div",[i("div",{staticClass:"text-16 font-medium truncate mb-8",staticStyle:{color:"#37393D","max-width":"140px"}},[t._v(t._s(t.item.itemBankExercise.title))]),i("div",{staticClass:"flex justify-between"},[i("div",{staticClass:"flex flex-col"},[i("div",{staticClass:"text-12 font-normal mb-4",staticStyle:{color:"#919399"}},[t._v("章节练习："),i("span",{staticStyle:{color:"#37393D"}},[t._v(t._s(t.item.chapterExerciseNum))])]),i("div",{staticClass:"text-12 font-normal",staticStyle:{color:"#919399"}},[t._v("试卷练习："),i("span",{staticStyle:{color:"#37393D"}},[t._v(t._s(t.item.assessmentNum))])])]),"1"!==t.hidePrice&&"1"!==t.item.itemBankExercise.hidePrice?i("div",{staticClass:"flex items-end text-14 font-semibold",staticStyle:{color:"#FF7E56","line-height":"16px"}},[i("span",{staticClass:"text-12 font-normal mr-2"},[t._v("¥")]),t._v(t._s(t.integerPart(t.item.itemBankExercise.price)+".")),i("span",{staticClass:"text-12",staticStyle:{"line-height":"14px"}},[t._v(t._s(t.decimalPart(t.item.itemBankExercise.price)))])]):t._e()])])])])}),[],!1,null,null,null);e.a=r.exports},c8a5:function(t,e,i){"use strict";i("6762"),i("2fdb");var s=i("3ce7"),n=i("faa5");i("a556"),e.a={data:function(){return{reportIntervalTime:null,reportLearnTime:null,reportFinishCondition:null,reportData:{courseId:null,taskId:null},reportResult:null,isFinish:!1,reportType:null,learnTime:0,isShowOutFocusMask:!1,outFocusMaskType:"",sign:"",record:{},absorbed:0,learnedTime:0,playKey:""}},beforeRouteLeave:function(t,e,i){this.sign.length>0&&localStorage.setItem("flowSign",this.sign),i()},beforeDestroy:function(){this.clearReportIntervalTime(),window.removeEventListener("beforeunload",this.onbeforeunloadFlowSign),this.toggleReportMaskHidden("remove")},methods:{initReportData:function(t,e,i,s){var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.clearReportIntervalTime(),this.reportData={courseId:t,taskId:e},this.reportType=i,this.playKey=s,this.isFinish=!1,this.reportIntervalTime=null,this.reportLearnTime=null,this.reportResult=null,this.learnTime=0,this.reportFinishCondition=null,n&&this.initReportEvent(),this.onbeforeunload()},initReportEvent:function(){this.reprtData(),this.intervalReportData(),this.intervalReportLearnTime()},getCourseData:function(t,e){var i=this,n={courseId:t,taskId:e};return new Promise((function(t,e){s.a.getCourseData({query:n}).then((function(e){i.reportFinishCondition=e.activity.finishCondition,t(e)})).catch((function(t){e(t)}))}))},reprtData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{eventName:"doing",ContinuousReport:!1,watchTime:null};if(null!==this.reportData.courseId&&null!==this.reportData.taskId&&(!this.isFinish||t.ContinuousReport))if(""===this.sign){var e={client:"h5"},i=localStorage.getItem("flowSign");i&&(e.lastSign=i,localStorage.removeItem("flowSign")),this.start(t,e)}else this.reportTaskEvent(t)},start:function(t,e){var i=this;s.a.reportTaskEvent({query:{courseId:this.reportData.courseId,taskId:this.reportData.taskId,eventName:"start"},data:e}).then((function(e){if(i.handleReportResult(e),e.learnControl.allowLearn)i.sign=e.record.flowSign,i.record=e.record,i.reportTaskEvent(t);else{var s=e.learnControl.denyReason;i.reportJudge(s)}}))},reportTaskEvent:function(t){var e=this;if(0!==this.sign.length){var i={client:"h5",sign:this.sign,duration:this.learnTime,status:this.absorbed,lastLearnTime:parseInt(localStorage.getItem(this.playKey))};if(t.reActive&&(i.reActive=t.reActive),this.sourceType&&"video"===this.sourceType){var n=parseInt(this.nowWatchTime-this.lastWatchTime);this.lastWatchTime=this.nowWatchTime;var r={watchData:{duration:n}};i=Object.assign(i,r)}this.learnTime=0,s.a.reportTaskEvent({query:{courseId:this.reportData.courseId,taskId:this.reportData.taskId,eventName:t.eventName},data:i}).then((function(t){if(e.handleReportResult(t),e.record=t.record,e.absorbed=0,e.sign=t.record.flowSign,!t.learnControl.allowLearn){var i=t.learnControl.denyReason;e.reportJudge(i)}})).catch((function(t){e.clearReportIntervalTime()}))}},handleReportResult:function(t){this.reportResult=t,this.learnedTime=t.learnedTime,t.taskResult&&"finish"===t.taskResult.status?(this.isFinish=!0,this.$store.commit(n.B,"finish"),this.$store.commit("course/".concat(n.F),t.completionRate)):this.$store.commit(n.B,"start")},intervalReportLearnTime:function(){var t=this;this.reportLearnTime=setInterval((function(){t.checkoutTime(),t.learnTime++}),1e3)},intervalReportData:function(){var t=this,e=60*(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1)*1e3;this.reportIntervalTime=setInterval((function(){t.reprtData({eventName:"doing",ContinuousReport:!0})}),e)},checkoutTime:function(){this.reportFinishCondition&&["time","watchTime"].includes(this.reportFinishCondition.type)&&parseInt(this.learnTime/60,10)>=parseInt(this.reportFinishCondition.data,10)&&this.reprtData({eventName:"finish",ContinuousReport:!0})},clearReportIntervalTime:function(){clearInterval(this.reportIntervalTime),clearInterval(this.reportLearnTime),this.reportIntervalTime=null,this.reportLearnTime=null},reportJudge:function(t){"kick_previous"===t?this.kickEachOther("kick_previous"):"reject_current"===t&&(this.clearReportIntervalTime(),this.kickEachOther("reject_current"))},outFocusMask:function(t){this.absorbed=1,this.isShowOutFocusMask=!1,!this.player||"video"!==this.reportType&&"audio"!==this.reportType||this.player.play(),this.toggleReportMaskHidden("remove"),this.reprtData({eventName:"doing",ContinuousReport:!0,reActive:1})},kickEachOther:function(t){if(this.absorbed=1,"testpaper"!==this.reportType&&"live"!==this.reportType&&"homework"!==this.reportType||"kick_previous"!==t){if(this.isShowOutFocusMask=!0,this.outFocusMaskType=t,"video"===this.reportType||"audio"===this.reportType){if(this.player&&this.player.destory&&"reject_current"===t)return void this.player.destory();this.player&&this.player.pause&&this.player.pause()}this.toggleReportMaskHidden("add")}},ineffectiveLearning:function(t){this.isShowOutFocusMask||(this.absorbed=0,this.isShowOutFocusMask=!0,this.outFocusMaskType=t,this.player&&"video"===this.reportType&&this.player.pause(),this.reprtData({eventName:"doing",ContinuousReport:!0}))},toggleReportMaskHidden:function(t){"video"!==this.reportType&&"audio"!==this.reportType&&("add"===t?document.getElementsByTagName("body")[0].classList.add("report-mask-hidden"):"remove"===t&&document.getElementsByTagName("body")[0].classList.remove("report-mask-hidden"))},initVisibilitychange:function(){document.addEventListener("visibilitychange",this.visibilityState)},visibilityState:function(){"video"===this.reportType&&("hidden"===document.visibilityState?this.ineffectiveLearning("ineffective_learning"):"visible"===document.visibilityState&&this.player.pause())},onbeforeunload:function(){window.addEventListener("beforeunload",this.onbeforeunloadFlowSign)},onbeforeunloadFlowSign:function(){this.sign.length>0&&localStorage.setItem("flowSign",this.sign)}}}},ccb4:function(t,e,i){},ce0d:function(t,e,i){"use strict";var s=i("158c");i.n(s).a},d331:function(t,e,i){"use strict";var s=i("8789");i.n(s).a},d824:function(t,e,i){"use strict";var s=i("2268");i.n(s).a},f13d:function(t,e,i){"use strict";i("8e6e"),i("ac6a"),i("456d");var s=i("75fc"),n=(i("e7e5"),i("d399")),r=i("bd86"),a=(i("c5f6"),i("3ce7"));function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}var c={props:{tips:{type:String,default:"placeholder.dragTheSliderToCompleteThePuzzle"},limitType:{type:String,default:""}},data:function(){return{imgInfo:{url:"",jigsaw:"",token:""},dragState:{left:0,width:0,currentX:0,currentLeft:0,btnWidth:0,maskWidth:0},dragToEnd:!1}},created:function(){this.initDragCaptcha()},mounted:function(){var t=this.$refs.bar,e=this.$refs.dragBtn,i=t.getBoundingClientRect();Object.assign(this.dragState,{left:Number(i.left.toFixed(2)),width:t.clientWidth,btnWidth:e.offsetWidth/2})},methods:{initDragCaptcha:function(){var t=this,e={};this.limitType&&(e={limitType:this.limitType}),a.a.dragCaptcha({data:e}).then((function(e){t.imgInfo=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach((function(e){Object(r.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},e),Object.assign(t.dragState,{currentLeft:0,maskWidth:0}),t.dragToEnd=!1})).catch((function(t){n.a.fail(t.message)}))},handletTouchEnd:function(){var t=this;if(!this.dragToEnd&&this.dragState.currentLeft){var e=this.getToken();this.dragToEnd=!0,a.a.dragValidate({query:{token:e}}).then((function(i){n.a.success(t.$t("e.verificationSuccess")),t.$emit("success",e)})).catch((function(e){n.a.fail(e.message),t.initDragCaptcha()}))}},handleTouchMove:function(t){if(!this.dragToEnd){t.preventDefault();var e=this.$refs.dragBtn,i=this.dragState,s=t.clientX?t.clientX.toFixed(2):t.targetTouches[0].pageX.toFixed(2)-this.$refs.drag.offsetLeft,n=(s-i.left-i.btnWidth).toFixed(2);n<0&&(n=0),s>i.width+this.$refs.drag.offsetLeft&&(n=i.width-this.$refs.dragImg.width),Object.assign(this.dragState,{currentLeft:n,maskWidth:(Number(n)+e.offsetWidth/2).toFixed(2)})}},calPositionX:function(){var t=this.$refs.dragImgBg,e=(t.naturalWidth/t.width).toFixed(2);return(Number(this.dragState.currentLeft).toFixed(2)*e).toFixed(2)},getToken:function(){var t={token:this.imgInfo.token,captcha:this.calPositionX()};return Object(s.a)(btoa(JSON.stringify(t))).reverse().join("")}}},u=i("a6c2"),l=Object(u.a)(c,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"drag",staticClass:"e-drag"},[i("div",{staticClass:"e-drag-section"},[i("div",{staticClass:"e-drag-img"},[i("img",{ref:"dragImgBg",attrs:{src:t.imgInfo.url,alt:""}}),i("img",{ref:"dragImg",staticClass:"e-drag-img__dragable",style:{left:t.dragState.currentLeft+"px"},attrs:{src:t.imgInfo.jigsaw,alt:""}})]),i("div",{ref:"bar",staticClass:"e-drag-bar"},[i("span",[t._v(t._s(t.$t(t.tips)))]),i("div",{staticClass:"e-drag-bar__mask",style:{width:t.dragState.maskWidth+"px"}}),i("div",{ref:"dragBtn",staticClass:"e-drag-btn",style:{left:t.dragState.currentLeft+"px"},on:{touchend:t.handletTouchEnd,touchmove:t.handleTouchMove}},[i("img",{attrs:{src:"static/images/drag.png",alt:""}})])])])])}),[],!1,null,null,null);e.a=l.exports},f54e:function(t,e,i){"use strict";var s=i("a362");i.n(s).a},f8b7:function(t,e,i){"use strict";var s={props:["openAppUrl","courseId","goodsId"],data:function(){return{appMiddlePageUrl:"/mobile/downloadMiddlePage?courseId=".concat(this.courseId,"&goodsId=").concat(this.goodsId),isWeixinBrowser:/micromessenger/.test(navigator.userAgent.toLowerCase()),isDingTalkBrowser:/ding\s?talk/i.test(navigator.userAgent.toLowerCase()),timeout:null}},mounted:function(){document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&this.timeout&&clearTimeout(this.timeout)}))},methods:{cancel:function(){this.$emit("cancel")},openMiddlePage:function(){var t=this;this.timeout=setTimeout((function(){window.location.href=t.appMiddlePageUrl,t.timeout=null}),1500)}}},n=(i("a30a"),i("a6c2")),r=Object(n.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"open-app-container"},[i("div",{staticClass:"open-app-overlay"}),i("div",{staticClass:"open-app-dialog"},[i("div",{staticClass:"message"},[t._v("将为您跳转至APP进行学习")]),i("div",{staticClass:"footer"},[i("button",{on:{click:function(e){return t.cancel()}}},[t._v("取消")]),t.isWeixinBrowser||t.isDingTalkBrowser?i("a",{attrs:{href:t.appMiddlePageUrl}},[t._v("继续")]):i("a",{attrs:{href:t.openAppUrl},on:{click:t.openMiddlePage}},[t._v("继续")])])])])}),[],!1,null,"14980bf2",null);e.a=r.exports},f9f2:function(t,e,i){},fc7c:function(t,e,i){"use strict";var s=i("3e0e");i.n(s).a},fd4a:function(t,e,i){"use strict";i.r(e),i("8e6e"),i("ac6a"),i("456d"),i("e17f");var s=i("2241"),n=(i("7f7f"),i("c5f6"),i("96cf"),i("3b8d")),r=i("bd86"),a=(i("a481"),i("e7e5"),i("d399")),o=(i("4917"),i("b127")),c=i("202a"),u=(i("6b54"),i("6762"),i("2fdb"),i("75fc")),l=i("2f62");function d(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function h(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?d(Object(i),!0).forEach((function(e){Object(r.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):d(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var p={name:"SwiperDirectory",props:{item:{type:Array,default:function(){return[]}},slideIndex:{type:Number,default:0},hasChapter:{type:Boolean,default:!0}},data:function(){return{current:this.slideIndex||0}},watch:{slideIndex:function(t,e){t!=e&&(this.current=t||0)}},computed:h(h({},Object(l.e)(["courseSettings"])),{},{swiperWidth:function(){var t=window.innerWidth;return t<=500?265:t/1.5}}),mounted:function(){},methods:{changeChapter:function(t){this.current=t,this.$emit("changeChapter",t)},handleChapter:function(t){this.$refs.chapterSwipe.swipeTo(t)}}},f=i("a6c2"),m=Object(f.a)(p,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"swiper-directory"},[i("van-swipe",{ref:"chapterSwipe",attrs:{"show-indicators":!1,loop:!1,touchable:!0,width:t.swiperWidth,"initial-swipe":t.slideIndex},on:{change:t.changeChapter}},t._l(t.item,(function(e,s){return i("van-swipe-item",{key:s},[0==e.isExist?i("div",{staticClass:"chapter nochapter",class:"swiper-directory-active",on:{click:function(e){return t.handleChapter(s)}}},[i("i",{staticClass:"iconfont icon-wuzhangjieliang"}),t._v("\n        "+t._s(t.$t("courseLearning.noChapter"))+"\n      ")]):t._e(),1==e.isExist?i("div",{staticClass:"chapter haschapter",class:[t.current===s?"swiper-directory-active":""],on:{click:function(e){return t.handleChapter(s)}}},[i("p",{staticClass:"chapter-title text-overflow"},[t._v("\n          第"+t._s(e.number)+t._s(t.courseSettings.chapter_name?t.courseSettings.chapter_name:t.$t("courseLearning.chapter"))+"："+t._s(e.title)+"\n        ")]),i("p",{staticClass:"chapter-des text-overflow"},[t._v("\n          "+t._s(t.hasChapter?"节("+e.unitNum+")":"")+" "+t._s(t.$t("courseLearning.lesson"))+"("+t._s(e.lessonNum)+") "+t._s(t.$t("courseLearning.learningTasks"))+"("+t._s(e.tasksNum)+")\n        ")])]):t._e()])})),1)],1)}),[],!1,null,null,null).exports;function v(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}var g={name:"UtilDirectory",props:{util:{type:Object,default:function(){}}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?v(Object(i),!0).forEach((function(e){Object(r.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):v(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},Object(l.e)(["courseSettings"]))},y=Object(f.a)(g,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return 1==t.util.isExist?i("div",{staticClass:"util-directory text-overflow"},[t._v("\n  第"+t._s(t.util.number)+t._s(t.courseSettings.part_name?t.courseSettings.part_name:t.$t("courseLearning.section2"))+"："+t._s(t.util.title)+"\n")]):t._e()}),[],!1,null,null,null).exports,b=i("d863"),k=i("2164"),C=i("faa5"),w=i("3ce7"),_=i("a556");function x(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function T(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?x(Object(i),!0).forEach((function(e){Object(r.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):x(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var I={name:"LessonDirectory",mixins:[b.a,k.a],props:{lesson:{type:Array,default:function(){return[]}},errorMsg:{type:String,default:""},taskId:{type:Number,default:-1},taskNumber:{type:Number,default:-1},unitNum:{type:Number,default:-1},courseSet:{type:Object,default:function(){}}},data:function(){return{currentTask:"",getAgainCourse:{},CONFIG:{android:"https://a.app.qq.com/o/simple.jsp?pkgname=com.edusoho.zhixiang",ios:"https://apps.apple.com/cn/app/知享学堂/id887301045",scheme:"com.qdxxzy.user://"}}},watch:{taskId:{handler:"getTaskId",immediate:!0}},computed:T(T(T({},Object(l.e)("course",{details:function(t){return t.details},joinStatus:function(t){return t.joinStatus},selectedPlanId:function(t){return t.selectedPlanId}})),Object(l.e)({isOnlyApp:function(t){var e;return null===(e=t.courseSettings)||void 0===e?void 0:e.only_learning_on_APP}})),{},{hasLesson:function(){return this.lesson.length>0},isNoData:function(){return 0===this.taskNumber&&0===this.unitNum}}),mounted:function(){if(Object.keys(this.$route.query).length){var t=this.$route.query,e=t.sourceType,i=t.taskId;this.setSourceType({sourceType:e,taskId:i})}},methods:T(T({},Object(l.d)("course",{setSourceType:C.A,setTaskStatus:C.B})),{},{getTaskId:function(){this.currentTask=this.taskId},doubleLine:function(t){if(!t.isReplay&&t.type)return"live"===t.type},showPaddingY:function(t){return"2k"===t||"4k"===t},showTask:function(t,e){var i=!0;return null==t.mode&&0==e&&(i=!1),"lesson"==t.mode&&(i=!1),i},isCanLearn:function(t){var e,i,s=["testpaper","homework","exercise"].includes(t.type),n=!t.result||"finish"!=t.result.status;return"closed"!==(null===(e=this.getAgainCourse)||void 0===e||null===(i=e.courseSet)||void 0===i?void 0:i.status)||!!s&&(!s||!n)},getCourse:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={courseId:t.selectedPlanId},e.next=3,w.a.getCourseDetail({query:i}).then((function(e){t.getAgainCourse=e}));case 3:case"end":return e.stop()}}),e)})))()},getData:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function i(){var s;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return s={},i.prev=1,i.next=4,w.a.getMedia({query:{courseId:e.selectedPlanId,taskId:t},params:{version:"escloud"}}).then((function(t){t.media&&(s=t.media)}));case 4:i.next=9;break;case 6:i.prev=6,i.t0=i.catch(1),console.log(i.t0);case 9:return i.abrupt("return",s);case 10:case"end":return i.stop()}}),i,null,[[1,6]])})))()},detectBrowserInfo:function(){var t=navigator.userAgent.toLowerCase(),e=/micromessenger/i.test(t),i=/wxwork/i.test(t),s=/dingtalk/i.test(t),n=/lark/i.test(t);return!!(e||i||s||n)},lessonCellClick:function(t,e,i){var s=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.getCourse();case 2:if(s.isCanLearn(t)){e.next=4;break}return e.abrupt("return",Object(_.a)("course"));case 4:if("live"!==t.type&&"video"!==t.type){e.next=14;break}return e.next=7,s.getData(t.id);case 7:if(!(i=e.sent).isEncryptionPlus||!i.securityVideoPlayer){e.next=11;break}return Object(a.a)("请在APP学习"),e.abrupt("return");case 11:if(!i.isEncryptionPlus||i.securityVideoPlayer||s.detectBrowserInfo()){e.next=14;break}return Object(a.a)("请在APP学习或使用钉钉/飞书/微信/企业微信内置浏览器打开"),e.abrupt("return");case 14:if(s.$store.commit(C.B,""),!s.errorMsg||Number(t.isFree)){e.next=18;break}return s.$emit("showDialog"),e.abrupt("return");case 18:if(!t.lock){e.next=21;break}return Object(a.a)(s.$t("courseLearning.needToUnlockThePreviousTask")),e.abrupt("return");case 21:if("create"!==t.status&&"published"===t.status){e.next=24;break}return Object(a.a)(s.$t("courseLearning.stayTuned")),e.abrupt("return");case 24:n={id:t.id},s.$store.commit("course/".concat(C.i),{nextTask:n}),!s.details.allowAnonymousPreview&&s.$router.push({name:"login",query:{redirect:s.redirect}}),s.joinStatus&&s.showTypeDetail(t);case 29:case"end":return e.stop()}}),e)})))()},showTypeDetail:function(t){var e=this;if("published"===t.status)switch(t.type){case"video":"self"===t.mediaSource?this.setSourceType({sourceType:"video",taskId:t.id}):Object(a.a)(this.$t("courseLearning.doesNotSupportThisType"));break;case"audio":this.setSourceType({sourceType:"audio",taskId:t.id});break;case"ppt":this.setSourceType({sourceType:"ppt",taskId:t.id});break;case"text":case"doc":this.$router.push({name:"course_web",query:{courseId:this.selectedPlanId,taskId:t.id,type:t.type}});break;case"live":var i=!1;if(new Date>new Date(1e3*t.endTime)&&"closed"===t.liveStatus){if("videoGenerated"==t.activity.replayStatus)return void this.setSourceType({sourceType:"video",taskId:t.id});if("ungenerated"==t.activity.replayStatus)return void Object(a.a)(this.$t("courseLearning.noReplay"));i=!0,this.setSourceType({sourceType:"video",taskId:t.id}),this.setTaskStatus("finish")}this.$router.push({name:"live",query:{courseId:this.selectedPlanId,taskId:t.id,type:t.type,title:t.title,replay:i}});break;case"testpaper":var n=t.activity.testpaperInfo,r=n.testpaperId,o=n.answerRecordId;w.a.testpaperIntro({params:{targetId:t.id,targetType:"task"},query:{testId:r}}).then((function(i){var s=i.task.activity.testpaperInfo.endTime,n=i.testpaperResult;"finished"!=(null===n||void 0===n?void 0:n.status)&&"reviewing"!=(null===n||void 0===n?void 0:n.status)||!(1e3*s>Date.now()||0==s||null==s)?e.$router.push({name:"testpaperIntro",query:{testId:r,targetId:t.id,courseId:e.$route.params.id}}):e.$router.push({name:"testpaperResult",query:{testId:r,targetId:t.id,resultId:o,courseId:e.$route.params.id}})})).catch((function(t){4032203===t.code?s.a.alert({title:"试卷已关闭",confirmButtonText:"确定",confirmButtonColor:"#00BE63"}):a.a.fail(t.message)}));break;case"homework":this.$router.push({name:"homeworkIntro",query:{courseId:this.$route.params.id,taskId:t.id}});break;case"exercise":this.$router.push({name:"exerciseIntro",query:{courseId:this.$route.params.id,taskId:t.id}});break;default:this.setSourceType({sourceType:"img",taskId:t.id}),this.copyPcUrl(t.courseUrl)}else Object(a.a)(this.$t("courseLearning.stayTuned"))},iconfont:function(t){var e=t.type;if(t.isReplay)return"icon-replay";switch(e){case"audio":return"icon-yinpin";case"doc":return"icon-wendang";case"exercise":return"icon-lianxi";case"flash":return"icon-flash";case"homework":return"icon-zuoye";case"live":return"icon-zhibo";case"ppt":return"icon-ppt";case"discuss":return"icon-taolun";case"testpaper":return"icon-kaoshi";case"text":return"icon-tuwen";case"video":return"icon-shipin";case"download":return"icon-xiazai";default:return""}},studyStatus:function(t){if(t.lock)return"icon-suo";if(null==t.result)return"icon-weixuexi";switch(t.result.status){case"finish":return"icon-yiwanchengliang";case"start":return"icon-weiwancheng";default:return""}},liveClass:function(t){return"published"!=t.status||"live"!=t.type?"nopublished":"generated"===t.activity.replayStatus?"back":"closed"===t.progressStatus?"end":"created"===t.progressStatus||"live"===t.progressStatus?"play":void 0}})};function O(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function S(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?O(Object(i),!0).forEach((function(e){Object(r.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):O(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var j={name:"AfterjoinDirectory",components:{swiperDirectory:m,utilDirectory:y,lessonDirectory:Object(f.a)(I,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._l(t.lesson,(function(e,s){return[t.hasLesson?i("div",{key:s,staticClass:"lesson-directory"},[i("div",{staticClass:"lesson-title flex justify-between items-center relative px-12",class:{"zb-ks":t.doubleLine(e.tasks[e.index]),"py-16":t.showPaddingY(e.tasks[e.index].videoMaxLevel)},attrs:{id:e.tasks[e.index].id},on:{click:function(i){return t.lessonCellClick(e.tasks[e.index],s,e.index)}}},[i("div",{staticClass:"lesson-title-r"},[i("div",{staticClass:"lesson-title-des"},[t.doubleLine(e.tasks[e.index])?t._e():i("div",{staticClass:"bl l22"},[i("span",{staticClass:"ks",class:{lessonactive:t.currentTask==e.tasks[e.index].id},staticStyle:{"align-items":"center"}},["2k"===e.tasks[e.index].videoMaxLevel?i("span",{staticClass:"px-8 text-white text-12 font-medium bg-black bg-opacity-80 rounded-bl-8 mr-8",staticStyle:{"padding-top":"3px","padding-bottom":"3px","line-height":"12px","border-bottom-left-radius":"8px","border-top-right-radius":"8px"}},[t._v("2K 优享")]):t._e(),"4k"===e.tasks[e.index].videoMaxLevel?i("span",{staticClass:"px-8 text-[#492F0B] text-12 font-medium bg-gradient-to-l from-[#F7D27B] to-[#FCEABE] mr-8",staticStyle:{"padding-top":"3px","padding-bottom":"3px","line-height":"12px","border-bottom-left-radius":"8px","border-top-right-radius":"8px"}},[t._v("4K 臻享")]):t._e(),i("i",{staticClass:"iconfont",class:t.iconfont(e.tasks[e.index])}),i("div",{staticClass:"flex flex-col"},[i("div",[t._v("\n                    "+t._s(Number(e.tasks[e.index].isOptional)?"":t.$t("courseLearning.lesson"))+t._s(Number(e.tasks[e.index].isOptional)?e.title:e.tasks[e.index].number+":"+e.title)+"\n                  ")]),i("br"),e.tasks[e.index].isLastLearn?i("div",{staticClass:"last-learn-task"},[t._v("上次学到")]):t._e()])])]),t.doubleLine(e.tasks[e.index])?i("div",{staticClass:"bl"},[i("div",{staticClass:"block-inline"},[i("span",{staticClass:"bl ks",class:{lessonactive:t.currentTask==e.tasks[e.index].id},staticStyle:{display:"flex"}},[i("i",{staticClass:"iconfont",class:t.iconfont(e.tasks[e.index])}),i("div",[t._v("\n                    "+t._s(Number(e.tasks[e.index].isOptional)?"":t.$t("courseLearning.lesson"))+t._s(Number(e.tasks[e.index].isOptional)?e.title:e.tasks[e.index].number+":"+e.title)+"\n                  ")])]),i("span",{staticClass:"bl zbtime"},[i("span",{class:[t.liveClass(e.tasks[e.index])]},[t._v(t._s(t._f("filterTaskTime")(e.tasks[e.index])))])]),e.tasks[e.index].isLastLearn?i("div",{staticClass:"last-learn-task"},[t._v("上次学到")]):t._e()])]):t._e()])]),i("div",{staticClass:"lesson-title-l"},[Number(e.tasks[e.index].isOptional)?i("span",{staticClass:"elective-tag"},[t._v("\n            "+t._s(t.$t("courseLearning.optional"))+"\n          ")]):t._e(),"live"!=e.tasks[e.index].type?i("span",[t._v(t._s(t._f("filterTaskTime")(e.tasks[e.index])))]):t._e(),i("i",{staticClass:"iconfont",class:t.studyStatus(e.tasks[e.index])})])]),e.tasks.length>1?i("div",{staticClass:"lesson-items"},[t._l(e.tasks,(function(e,n){return[t.showTask(e,n)?i("div",{key:n,staticClass:"litem",attrs:{id:e.id},on:{click:function(i){return t.lessonCellClick(e,s,n)}}},[i("div",{staticClass:"litem-r",class:{lessonactive:t.currentTask==Number(e.id)}},[i("i",{staticClass:"iconfont",class:t.iconfont(e)}),i("div",[t._v("\n                "+t._s(Number(e.isOptional)?"":t.$t("courseLearning.lesson"))+t._s(Number(e.isOptional)?e.title:e.number+":"+e.title)+"\n              ")])]),i("div",{staticClass:"litem-l clearfix"},[i("span",{class:[t.liveClass(e)]},[t._v(t._s(t._f("filterTaskTime")(e)))]),i("i",{staticClass:"iconfont",class:t.studyStatus(e)})])]):t._e()]}))],2):t._e()]):t._e()]})),t.isNoData?i("div",{staticClass:"noneItem"},[i("img",{staticClass:"notask",attrs:{src:"static/images/none.png"}}),i("p",[t._v(t._s(t.$t("courseLearning.thereIsNoClassYet")))])]):t._e()],2)}),[],!1,null,"7c76bec1",null).exports},props:{courseSet:{type:Object,default:function(){}}},data:function(){return{scroll:"",item:[],level:3,chapterNum:0,unitNum:0,lessonNum:0,currentChapter:0,currentUnit:0,currentLesson:0,slideIndex:0,taskId:null,nodata:!1,allTask:{},allTaskId:[]}},computed:S(S({},Object(l.e)("course",{nextStudy:function(t){return t.nextStudy},selectedPlanId:function(t){return t.selectedPlanId},OptimizationCourseLessons:function(t){return t.OptimizationCourseLessons},details:function(t){return t.details},taskStatus:function(t){return t.taskStatus}})),{},{hasChapter:function(){return this.chapterNum>0}}),watch:{nextStudy:{handler:"getNextStudy",immediate:!0},selectedPlanId:{handler:"processItem",immediate:!0,deep:!0},taskStatus:{handler:"changeTaskStatus",immediate:!1}},mounted:function(){this.$route.query.lastLearnTaskId&&this.$route.query.lastLearnTaskType&&this.initLastLearnTaskEvent()},methods:S(S({},Object(l.d)("course",{setSourceType:C.A})),{},{getCurrentChapterTaskIds:function(t){var e=this;return t.flatMap((function(t){var i=(t.tasks||[]).map((function(t){return t.id})).filter(Boolean),s=t.children?e.getCurrentChapterTaskIds(t.children):[];return[].concat(Object(u.a)(i),Object(u.a)(s))}))},initLastLearnTaskEvent:function(){var t=this.$route.query,e=t.lastLearnTaskType,i=t.lastLearnTaskId;this.setSourceType({sourceType:e,taskId:i});var s=this.getCurrentChapterTaskIds(this.item[this.slideIndex].children),n=document.getElementById(i);n&&s.includes(i)&&n.click()},getNextStudy:function(){if(this.nextStudy.nextTask){this.taskId=Number(this.nextStudy.nextTask.id);var t=this.allTask[this.taskId];if(!t)return;this.hasChapter?this.slideIndex=t.chapterIndex:this.slideIndex=t.unitIndex}},processItem:function(t){var e=this.OptimizationCourseLessons;this.resetData(),e.length?(this.nodata=!1,this.setItems(e),this.mapChild(this.item),this.startScroll(),this.$store.commit("course/".concat(C.n),this.allTask)):this.nodata=!0},resetData:function(){this.chapterNum=0,this.unitNum=0,this.lessonNum=0},setItems:function(t){this.level=1===t.length&&0==t[0].isExist?2:3,1===t.length?this.item=2===this.level?t[0].children:t:t.length>1&&(this.item=t)},mapChild:function(t){var e=this;t.map((function(i,s){"chapter"===i.type?e.formatChapter(i,t,s):"unit"===i.type?e.formatUnit(i,t,s):"lesson"===i.type?e.formatLesson(i,t,s):e.formatTask(i,t,s)}))},startScroll:function(){var t=this;this.$nextTick((function(){if(t.taskId){var e=document.getElementById("progress-bar"),i=document.getElementById("swiper-directory"),s=document.getElementById(t.taskId),n=e?e.offsetHeight:0,r=i?i.offsetHeight:0,a=(s?s.offsetTop:0)-n-44-r;a<document.documentElement.clientWidth||window.scrollTo({top:a})}}))},formatChapter:function(t,e,i){this.currentChapter=i,t.chapterNum=0,t.unitNum=0,t.lessonNum=0,t.tasksNum=0,t.isExist&&(this.chapterNum+=1,this.computedNum(1,"chapterNum")),Array.isArray(t.children)&&t.children.length>0&&this.mapChild(t.children)},formatUnit:function(t,e,i){this.currentUnit=i,t.unitNum=0,t.lessonNum=0,t.tasksNum=0,t.isExist&&(this.unitNum+=1,this.computedNum(1,"unitNum")),Array.isArray(t.children)&&t.children.length>0&&(this.computedNum(t.children.length,"lessonNum"),this.mapChild(t.children))},formatLesson:function(t,e,i){this.currentLesson=i,t.isExist&&(this.lessonNum+=1),t.tasks&&(this.computedNum(t.tasks.length-1,"tasksNum"),this.mapChild(t.tasks))},formatTask:function(t,e,i){Number(t.id)===this.taskId&&(this.slideIndex=3==this.level?this.currentChapter:this.currentUnit),this.getLessonIndex(t,i),t.chapterIndex=this.currentChapter,t.unitIndex=this.currentUnit,t.LessonIndex=this.currentLesson,t.level=this.level,t.taskIndex=i,this.allTask[t.id]=S({},t),this.allTaskId.push(t.id)},getLessonIndex:function(t,e){t.mode?"lesson"===t.mode&&this.getMainTask(t,e):this.getMainTask(t,0)},getMainTask:function(t,e){3===this.level?this.$set(this.item[this.currentChapter].children[this.currentUnit].children[this.currentLesson],"index",e):this.$set(this.item[this.currentUnit].children[this.currentLesson],"index",e)},computedNum:function(t,e){var i=3===this.level?this.currentChapter:this.currentUnit,s=this.item[i][e]+t;this.$set(this.item[i],e,s)},changeChapter:function(t){this.slideIndex=t},changeTaskStatus:function(t){if(t){"finish"===t&&this.changeLockStatus();var e=this.allTask[this.taskId],i={};if(2===e.level){var s=this.item[e.unitIndex].children[e.LessonIndex].tasks[e.taskIndex];s.result?s.result.status=t:(i.status=t,s.result=i)}else{var n=this.item[e.chapterIndex].children[e.unitIndex].children[e.LessonIndex].tasks[e.taskIndex];n.result?n.result.status=t:(i.status=t,n.result=i)}}},changeLockStatus:function(){if("lockMode"===this.details.learnMode){var t=this.allTaskId.indexOf(this.taskId.toString());if(t<this.allTaskId.length-1){var e=this.allTaskId[t+1],i=this.allTask[e];2===i.level?this.item[i.unitIndex].children[i.LessonIndex].tasks[i.taskIndex].lock=!1:this.item[i.chapterIndex].children[i.unitIndex].children[i.LessonIndex].tasks[i.taskIndex].lock=!1}}}})},L=(i("fc7c"),Object(f.a)(j,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"afterjoin-directory"},[t.lessonNum>0?i("div",[t.chapterNum>0||t.unitNum>0?i("swiper-directory",{attrs:{id:"swiper-directory",item:t.item,"slide-index":t.slideIndex,"has-chapter":t.hasChapter},on:{changeChapter:t.changeChapter}}):t._e(),t.item.length>0?i("div",{attrs:{id:"lesson-directory"}},[t.chapterNum>0?t._l(t.item[t.slideIndex].children,(function(e,s){return i("div",{key:s,staticClass:"pd-bo"},[i("util-directory",{attrs:{util:e}}),i("lesson-directory",t._g(t._b({attrs:{lesson:e.children,"task-id":t.taskId,"task-number":t.item[t.slideIndex].lessonNum,"unit-num":t.item[t.slideIndex].unitNum,"course-set":t.courseSet}},"lesson-directory",t.$attrs,!1),t.$listeners))],1)})):i("div",{staticClass:"pd-bo"},[i("lesson-directory",t._g(t._b({attrs:{lesson:t.item[t.slideIndex].children,"task-id":t.taskId,"task-number":t.item[t.slideIndex].lessonNum,"unit-num":t.item[t.slideIndex].unitNum,"course-set":t.courseSet}},"lesson-directory",t.$attrs,!1),t.$listeners))],1)],2):t._e()],1):t._e(),t.nodata&&0==t.lessonNum?i("div",{staticClass:"noneItem"},[i("img",{staticClass:"nodata",attrs:{src:"static/images/none.png"}}),i("p",[t._v(t._s(t.$t("courseLearning.thereIsNoCourseYet")))])]):t._e()])}),[],!1,null,"3d0d4da7",null).exports),D=i("2095"),P=i("63dd"),$=i("4928"),E=i("39ed"),R=i("2ef0"),A=i.n(R),N=(i("4662"),i("28a2")),F={name:"DiscussionItem",props:{item:{type:Object,required:!0}},methods:{readFile:function(t){Object(N.a)({images:this.item.imgs,showIndex:!0,loop:!0,closeOnPopstate:!0,startPosition:t})}},computed:{content:function(){return this.item.content.replace(/<img .*?>/g,"")}}},B=(i("d824"),Object(f.a)(F,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"discussion-item"},[i("h3",{staticClass:"discussion-title text-overflow"},[t._v(t._s(t.item.title))]),i("p",{staticClass:"discussion-desc",domProps:{innerHTML:t._s(t.content)}}),i("div",{staticClass:"discussion-details"},[i("div",{staticClass:"discussion-details__left"},[i("img",{staticClass:"user-avatar",attrs:{src:t.item.user.avatar.small}}),i("span",[t._v(t._s(t.item.user.nickname)+"\n        "+t._s(t._f("formatCourseTime")(t.item.createdTime)))])]),i("div",{staticClass:"discussion-details__right"},[i("i",{staticClass:"iconfont icon-review"}),t._v("\n      "+t._s(t.item.postNum)+"\n    ")])]),i("div",{staticClass:"discussion-list"},t._l(t.item.imgs,(function(e,s){return i("van-image",{key:s,attrs:{width:"100",height:"100",src:e},on:{click:function(e){return e.stopPropagation(),t.readFile(s)}}})})),1)])}),[],!1,null,"bb7440d0",null).exports),q=i("2d42"),M={name:"DiscussionList",components:{DiscussionItem:B,Empty:q.a},props:{type:{type:String,required:!0},details:{type:Object,default:function(){return{}}}},data:function(){return{list:[],loading:!1,finished:!1,paging:{offset:0,limit:10},courseId:this.$route.params.id}},computed:{emptyText:function(){return"question"===this.type?this.$t("courseLearning.noQA"):this.$t("courseLearning.noTopics")},createText:function(){return"question"===this.type?this.$t("courseLearning.initiateQA"):this.$t("courseLearning.initiateTopics")}},methods:{onLoad:function(){var t=this,e=this.paging,i=e.offset,s=e.limit;w.a.getCoursesThreads({query:{courseId:this.courseId},params:{type:this.type,limit:s,offset:i*s}}).then((function(e){var i=e.data,s=e.paging.total;A.a.assign(t,{list:A.a.concat(t.list,i),loading:!1}),t.paging.offset++,A.a.size(t.list)>=s&&(t.finished=!0)}))},handleClickViewDetail:function(t){this.$emit("change-current-component",{component:"Detail",data:t})},handleClickCreateDiscussion:function(){var t,e;if("closed"==(null===(t=this.details)||void 0===t||null===(e=t.courseSet)||void 0===e?void 0:e.status))return Object(_.a)("course");this.$emit("change-current-component",{component:"Create"})}}},U=(i("0d18"),Object(f.a)(M,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"discussion-list"},[i("van-list",{attrs:{finished:t.finished,"loading-text":t.$t("toast.loading")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return i("discussion-item",{key:e.id,attrs:{item:e},nativeOn:{click:function(i){return t.handleClickViewDetail(e)}}})})),1),!t.list.length&&t.finished?i("empty",{attrs:{text:t.emptyText}}):t._e(),"closed"!=t.details.courseSet.status?i("div",{staticClass:"create-btn"},[i("van-button",{attrs:{type:"primary",block:""},on:{click:t.handleClickCreateDiscussion}},[t._v("\n      "+t._s(t.createText)+"\n    ")])],1):t._e()],1)}),[],!1,null,"45a0f931",null).exports),W={name:"ReplyItem",props:{item:{type:Object,required:!0}}},z=(i("870c"),{name:"DiscussionDetail",components:{ReplyItem:Object(f.a)(W,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"reply-item"},[i("div",{staticClass:"reply-item__info"},[i("img",{staticClass:"avatar",attrs:{src:t.item.user.avatar.small}}),i("span",[t._v(t._s(t.item.user.nickname)+" "+t._s(t._f("formatCourseTime")(t.item.createdTime)))])]),i("div",{staticClass:"reply-item__content",domProps:{innerHTML:t._s(t.item.content)}})])}),[],!1,null,"4a24d91f",null).exports},props:{discussion:{type:Object,required:!0},details:{type:Object,default:function(){}},type:{type:String,required:!0}},data:function(){return{content:"",courseId:this.$route.params.id,loading:!1,finished:!1,paging:{offset:0,limit:10},replyList:[]}},computed:{titleText:function(){return"question"===this.type?this.$t("courseLearning.QADetails"):this.$t("courseLearning.topicDetails")}},methods:{readFile:function(t){Object(N.a)({images:this.discussion.imgs,showIndex:!0,loop:!0,closeOnPopstate:!0,startPosition:t})},fetchCourseThreadPost:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var i,s,n,r,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.paging,s=i.offset,n=i.limit,e.next=3,w.a.getCoursesThreadPost({query:{courseId:t.courseId,threadId:t.discussion.id},params:{limit:n,offset:s*n}});case 3:r=e.sent,a=r.data,o=r.paging.total,A.a.assign(t,{replyList:A.a.concat(t.replyList,a),loading:!1}),t.paging.offset++,A.a.size(t.replyList)>=o&&(t.finished=!0);case 9:case"end":return e.stop()}}),e)})))()},handleClickGoToList:function(){this.$emit("change-current-component",{component:"List"})},handleClickEnter:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("closed"!=t.details.courseSet.status){e.next=2;break}return e.abrupt("return",Object(_.a)("course"));case 2:if(i=A.a.trim(t.content)){e.next=6;break}return t.$toast(t.$t("courseLearning.pleaseEnterContent")),e.abrupt("return");case 6:return e.next=8,w.a.createCoursesThreadPost({query:{courseId:t.courseId,threadId:t.discussion.id},data:{content:i}});case 8:s=e.sent,t.replyList.unshift(s),t.content="";case 11:case"end":return e.stop()}}),e)})))()}}}),H=(i("19d9"),Object(f.a)(z,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"discussion-detail"},[i("div",{staticClass:"detail-header"},[i("van-icon",{attrs:{name:"cross",size:"18px",color:"#000"},on:{click:t.handleClickGoToList}}),i("h3",{staticClass:"detail-header__title"},[t._v(t._s(t.titleText))])],1),i("div",{staticClass:"discussion-body"},[i("div",{staticClass:"discussion-body__info"},[i("img",{staticClass:"avatar",attrs:{src:t.discussion.user.avatar.small}}),i("div",{staticClass:"info-right"},[i("span",[t._v(t._s(t.discussion.user.nickname))]),i("span",[t._v(t._s(t._f("formatCourseTime")(t.discussion.createdTime)))])])]),i("div",{staticClass:"discussion-body__title"},[t._v(t._s(t.discussion.title))]),i("div",{staticClass:"discussion-body__content",domProps:{innerHTML:t._s(t.discussion.content)}}),i("div",{staticClass:"discussion-list"},t._l(t.discussion.imgs,(function(e,s){return i("van-image",{key:s,attrs:{width:"100",height:"100",src:e},on:{click:function(e){return e.stopPropagation(),t.readFile(s)}}})})),1)]),i("van-list",{attrs:{finished:t.finished},on:{load:t.fetchCourseThreadPost},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.replyList,(function(t){return i("reply-item",{key:t.id,attrs:{item:t}})})),1),i("div",{staticClass:"reply"},[i("van-field",{ref:"replyInput",attrs:{placeholder:t.$t("courseLearning.reply2")},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),i("span",{staticClass:"reply-btn",on:{click:t.handleClickEnter}},[t._v(t._s(t.$t("courseLearning.reply")))])],1)],1)}),[],!1,null,"71f1a6f0",null).exports),G={name:"DiscussionCreate",props:{type:{type:String,required:!0}},data:function(){return{title:"",content:"",fileList:[],imgs:[]}},computed:{text:function(){var t=this,e={question:{title:"courseLearning.sendQA",placeholderTitle:"courseLearning.QATitle",placeholderContent:"courseLearning.QAContent"},discussion:{title:"courseLearning.postTopic",placeholderTitle:"courseLearning.topicTitle",placeholderContent:"courseLearning.topicContent"}}[this.type];return A.a.forEach(e,(function(i,s){e[s]=t.$t(i)})),e}},methods:{handleClickGoToList:function(){this.$emit("change-current-component",{component:"List"})},createDiscussion:function(){var t=this;this.$refs.form.validate().then(Object(n.a)(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.$route.params.id,e.next=3,w.a.createCoursesThread({query:{courseId:i},data:{content:t.content,courseId:i,type:t.type,title:t.title,imgs:t.imgs}});case 3:t.handleClickGoToList();case 4:case"end":return e.stop()}}),e)}))))},afterRead:function(t){var e=this,i=new FormData;i.append("file",t.content),i.append("group","course"),w.a.updateFile({data:i}).then((function(t){e.imgs.push(t.uri)})).catch((function(t){a.a.fail(t.message)}))},deleteImgItem:function(t,e){this.imgs.splice(e.index,1)}}},V=(i("0b19"),Object(f.a)(G,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"discussion-create"},[i("div",{staticClass:"create-header"},[i("van-icon",{attrs:{name:"cross",size:"18px",color:"#000"},on:{click:t.handleClickGoToList}}),i("h3",{staticClass:"create-header__title"},[t._v(t._s(t.text.title))]),i("span",{staticClass:"create-header__btn",on:{click:t.createDiscussion}},[t._v(t._s(t.$t("courseLearning.publish")))])],1),i("van-form",{ref:"form"},[i("div",{staticClass:"discussion-create__title"},[i("van-field",{attrs:{error:!1,placeholder:t.text.placeholderTitle,rules:[{required:!0,message:t.$t("courseLearning.pleaseEnterATitle")}]},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),i("div",{staticClass:"discussion-create__content"},[i("van-field",{attrs:{type:"textarea",rows:"1",error:!1,autosize:"",placeholder:t.text.placeholderContent,rules:[{required:!0,message:t.$t("courseLearning.pleaseEnterContent")}]},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),i("div",{staticClass:"discussion-create__upload"},[i("van-uploader",{attrs:{"after-read":t.afterRead,"max-count":6},on:{delete:t.deleteImgItem},model:{value:t.fileList,callback:function(e){t.fileList=e},expression:"fileList"}})],1)])],1)}),[],!1,null,"7fd42935",null).exports),K={name:"Discussion",components:{List:U,Detail:H,Create:V},props:{type:{type:String,required:!0},details:{type:Object,default:function(){return{}}}},data:function(){return{currentComponent:"List",currentDiscussion:{}}},watch:{currentComponent:function(){this.$emit("chang-tabs-status","List"===this.currentComponent)}},methods:{changeCurrentComponent:function(t){var e=t.component,i=t.data;A.a.assign(this,{currentComponent:e,currentDiscussion:i})}}},J=Object(f.a)(K,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"discussion"},[e(this.currentComponent,{tag:"component",attrs:{discussion:this.currentDiscussion,type:this.type,details:this.details},on:{"change-current-component":this.changeCurrentComponent}})],1)}),[],!1,null,null,null).exports,Q={name:"Discussion",components:{List:U,Detail:H,Create:V},props:{type:{type:String,required:!0},details:{type:Object,default:function(){return{}}}},data:function(){return{currentComponent:"List",currentDiscussion:{}}},watch:{currentComponent:function(){this.$emit("chang-tabs-status","List"===this.currentComponent)}},methods:{changeCurrentComponent:function(t){var e=t.component,i=t.data;A.a.assign(this,{currentComponent:e,currentDiscussion:i})}}},X=Object(f.a)(Q,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"discussion"},[e(this.currentComponent,{tag:"component",attrs:{discussion:this.currentDiscussion,type:this.type,details:this.details},on:{"change-current-component":this.changeCurrentComponent}})],1)}),[],!1,null,null,null).exports,Y={name:"NoteItem",props:{item:{type:Object,required:!0}},computed:{content:function(){return this.item.content.replace(/<img .*?>/g,"")},isLike:function(){return!!A.a.size(this.item.like)}}},Z=(i("d331"),{name:"Note-list",components:{NoteItem:Object(f.a)(Y,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"note-item"},[i("div",{staticClass:"note-item__top"},[i("div",{staticClass:"note-info"},[i("img",{staticClass:"avatar",attrs:{src:t.item.user.avatar.small,alt:""}}),i("span",[t._v(t._s(t.item.user.nickname)+" "+t._s(t._f("formatCourseTime")(t.item.createdTime)))]),i("span",{staticClass:"tag text-overflow"},[t._v(t._s(t.item.task.title))])]),i("div",{staticClass:"note-like",class:{like:t.isLike}},[i("i",{staticClass:"iconfont icon-like"}),t._v("\n      "+t._s(t.item.likeNum)+"\n    ")])]),i("div",{staticClass:"note-item__content",domProps:{innerHTML:t._s(t.content)}})])}),[],!1,null,"6611b010",null).exports,Empty:q.a},data:function(){return{list:[],loading:!1,finished:!1,paging:{offset:0,limit:10},courseId:this.$route.params.id}},methods:{onLoad:function(){var t=this,e=this.paging,i=e.offset,s=e.limit;w.a.getCoursesNotes({query:{courseId:this.courseId},params:{limit:s,offset:i*s}}).then((function(e){var i=e.data,s=e.paging.total;A.a.assign(t,{list:A.a.concat(t.list,i),loading:!1}),t.paging.offset++,A.a.size(t.list)>=s&&(t.finished=!0)}))},handleClickViewDetail:function(t){this.$emit("change-current-component",{component:"Detail",data:t})}}}),tt=(i("4980"),Object(f.a)(Z,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"note-list"},[i("van-list",{attrs:{finished:t.finished,"loading-text":t.$t("toast.loading")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return i("note-item",{key:e.id,attrs:{item:e},nativeOn:{click:function(i){return t.handleClickViewDetail(e)}}})})),1),!t.list.length&&t.finished?i("empty",{attrs:{text:t.$t("courseLearning.noNotes")}}):t._e()],1)}),[],!1,null,"6abcc50e",null).exports),et={name:"NoteDetail",props:{note:{type:Object,required:!0},details:{type:Object,default:function(){}}},data:function(){return{noteDetail:this.note,courseId:this.$route.params.id}},computed:{isLike:function(){return!!A.a.size(this.noteDetail.like)}},watch:{note:function(){this.noteDetail=this.note}},methods:{handleClickGoToList:function(){this.$emit("change-current-component",{component:"List"})},handleClickLike:function(){var t,e;if("closed"==(null===(t=this.details)||void 0===t||null===(e=t.courseSet)||void 0===e?void 0:e.status))return Object(_.a)("course");var i=this.noteDetail,s=i.id,n=i.likeNum,r={courseId:this.courseId,noteId:s},a=this.isLike?{like:{},likeNum:n-1}:{like:{status:1},likeNum:1*n+1};this.isLike?w.a.cancelNoteLike({query:r}):w.a.noteLike({query:r}),A.a.assign(this.noteDetail,a)}}},it=(i("7659"),{name:"Notes",components:{List:tt,Detail:Object(f.a)(et,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"note-detail"},[i("div",{staticClass:"detail-header"},[i("van-icon",{attrs:{name:"cross",size:"18px",color:"#000"},on:{click:t.handleClickGoToList}}),i("h3",{staticClass:"detail-header__title"},[t._v(t._s(t.$t("courseLearning.noteDetails")))])],1),i("div",{staticClass:"note-body"},[i("div",{staticClass:"note-body__info"},[i("img",{staticClass:"avatar",attrs:{src:t.note.user.avatar.small}}),i("div",{staticClass:"info-right"},[i("span",[t._v(t._s(t.note.user.nickname))]),i("div",{staticClass:"info-right-bottom"},[i("div",{staticClass:"info"},[i("span",{staticClass:"info-time"},[t._v(t._s(t._f("formatCourseTime")(t.note.createdTime)))]),i("span",{staticClass:"info-task text-overflow"},[t._v(t._s(t.note.task.title))])]),i("span",{staticClass:"like-num",class:{like:t.isLike},on:{click:t.handleClickLike}},[i("i",{staticClass:"iconfont icon-like"}),t._v("\n            "+t._s(t.noteDetail.likeNum)+"\n          ")])])])]),i("div",{staticClass:"note-body__content",domProps:{innerHTML:t._s(t.note.content)}})])])}),[],!1,null,"3cc6be4e",null).exports},props:{details:{type:Object,default:function(){}}},data:function(){return{currentComponent:"List",currentNote:{}}},watch:{currentComponent:function(){this.$emit("chang-tabs-status","List"===this.currentComponent)}},methods:{changeCurrentComponent:function(t){var e=t.component,i=t.data;A.a.assign(this,{currentComponent:e,currentNote:i})}}}),st=Object(f.a)(it,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"notes"},[e("keep-alive",[e(this.currentComponent,{tag:"component",attrs:{note:this.currentNote,details:this.details},on:{"change-current-component":this.changeCurrentComponent}})],1)],1)}),[],!1,null,null,null).exports,nt={name:"ReviewItem",props:{item:{type:Object,required:!0}},data:function(){return{isOverflow:!0,isAllBtn:!1}},computed:{allConentBtnText:function(){return this.isOverflow?this.$t("courseLearning.showAll"):this.$t("courseLearning.collapse")},classObject:function(){return{overflow:this.isOverflow,mask:this.isAllBtn&&this.isOverflow}}},mounted:function(){this.checkOverFlow()},methods:{checkOverFlow:function(){var t=this.$refs.content;this.isAllBtn=t.scrollHeight>t.clientHeight},handleClickToggleOverflow:function(){this.isOverflow=!this.isOverflow}}};function rt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function at(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?rt(Object(i),!0).forEach((function(e){Object(r.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):rt(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}i("8b9a");var ot={name:"ReviewsCreate",components:{ReviewItem:Object(f.a)(nt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"review-item"},[i("div",{staticClass:"user-avatar"},[i("img",{attrs:{src:t.item.user.avatar.small}})]),i("div",{staticClass:"review-detail"},[i("div",{staticClass:"review-detail__rate"},[i("div",{staticClass:"nickname"},[t._v(t._s(t.item.user.nickname))]),i("van-rate",{attrs:{value:1*t.item.rating,size:16,color:"#ffd21e","void-icon":"star","void-color":"#eee"}})],1),i("div",{staticClass:"review-detail__time"},[t._v(t._s(t._f("formatCourseTime")(t.item.createdTime)))]),i("div",{ref:"content",staticClass:"review-detail__content",class:t.classObject,domProps:{innerHTML:t._s(t.item.content)}}),t.isAllBtn?i("div",{staticClass:"all-content-btn",on:{click:t.handleClickToggleOverflow}},[t._v(t._s(t.allConentBtnText))]):t._e()])])}),[],!1,null,"8e39fbde",null).exports,Empty:q.a},props:{userReview:{type:Object,required:!0},details:{type:Object,default:function(){}},targetInfo:{type:Object,required:!0}},data:function(){return{list:[],loading:!1,finished:!1,paging:{offset:0,limit:10}}},computed:{createReviewBtnText:function(){return A.a.size(this.userReview)?this.$t("courseLearning.reEvaluation"):this.$t("courseLearning.writeEvaluation")}},methods:{onLoad:function(){var t=this,e=this.paging,i=e.offset,s=e.limit;w.a.getReview({params:at(at({},this.targetInfo),{},{limit:s,offset:i*s})}).then((function(e){var i=e.data,s=e.paging.total;A.a.assign(t,{list:A.a.concat(t.list,i),loading:!1}),t.paging.offset++,A.a.size(t.list)>=s&&(t.finished=!0)}))},handleClickCreateDiscussion:function(){var t,e;if("closed"==(null===(t=this.details)||void 0===t||null===(e=t.courseSet)||void 0===e?void 0:e.status))return Object(_.a)("course");this.$emit("change-current-component",{component:"Create"})}}},ct=(i("f54e"),Object(f.a)(ot,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"reviews-list"},[i("van-list",{attrs:{finished:t.finished,"loading-text":t.$t("toast.loading")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(t){return i("review-item",{key:t.id,attrs:{item:t}})})),1),!t.list.length&&t.finished?i("empty",{attrs:{text:t.$t("courseLearning.noContent")}}):t._e(),"closed"!=t.details.courseSet.status?i("div",{staticClass:"create-btn"},[i("van-button",{attrs:{type:"primary",block:""},on:{click:t.handleClickCreateDiscussion}},[t._v("\n      "+t._s(t.createReviewBtnText)+"\n    ")])],1):t._e()],1)}),[],!1,null,"76468528",null).exports);function ut(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function lt(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ut(Object(i),!0).forEach((function(e){Object(r.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ut(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var dt={name:"ReviewCreate",components:{EDrag:i("f13d").a},props:{userReview:{type:Object,required:!0},targetInfo:{type:Object,required:!0}},data:function(){return{rating:1*this.userReview.rating||0,content:this.userReview.content||"",rateHasError:!1,showDrag:!1}},methods:{handleClickGoToList:function(){this.$emit("change-current-component",{component:"List"})},createReview:function(){var t=this;this.rateHasError=!this.rating,this.$refs.form.validate().then(Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.rateHasError){e.next=2;break}return e.abrupt("return");case 2:t.showDrag=!0;case 3:case"end":return e.stop()}}),e)}))))},handleSmsSuccess:function(t){var e=this;this.showDrag=!1,w.a.createReview({data:lt(lt({},this.targetInfo),{},{content:this.content,rating:this.rating,_dragCaptchaToken:t})}).then((function(t){e.$emit("change-current-component",{component:"List",data:t})}))}}};function ht(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function pt(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ht(Object(i),!0).forEach((function(e){Object(r.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ht(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}i("ce0d");var ft={name:"Reviews",components:{List:ct,Create:Object(f.a)(dt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"review-create"},[i("div",{staticClass:"create-header"},[i("van-icon",{attrs:{name:"cross",size:"18px",color:"#000"},on:{click:t.handleClickGoToList}}),i("h3",{staticClass:"create-header__title"},[t._v(t._s(t.$t("courseLearning.evaluation")))]),i("span",{staticClass:"create-header__btn",on:{click:t.createReview}},[t._v(t._s(t.$t("courseLearning.publish")))])],1),i("van-form",{ref:"form"},[i("div",{staticClass:"review-create__rate"},[i("van-rate",{attrs:{size:24,color:"#ffd21e","void-icon":"star","void-color":"#eee"},model:{value:t.rating,callback:function(e){t.rating=e},expression:"rating"}}),t.rateHasError?i("p",{staticClass:"error-message"},[t._v(t._s(t.$t("courseLearning.scoring")))]):t._e()],1),i("div",{staticClass:"review-create__content"},[i("van-field",{attrs:{type:"textarea",rows:"3",error:!1,autosize:"",placeholder:t.$t("courseLearning.evaluationContent"),rules:[{required:!0,message:t.$t("courseLearning.inputEvaluationContent")}]},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)]),i("van-popup",{staticStyle:{width:"95%"},model:{value:t.showDrag,callback:function(e){t.showDrag=e},expression:"showDrag"}},[i("e-drag",{ref:"dragComponent",staticStyle:{width:"auto"},on:{success:t.handleSmsSuccess}})],1)],1)}),[],!1,null,"6c6e2840",null).exports},props:{details:{type:Object,required:!0}},data:function(){return{currentComponent:"List",userReview:{},courseId:this.$route.params.id}},computed:pt(pt({},Object(l.e)({user:function(t){return t.user}})),{},{targetInfo:function(){var t=this.details,e=t.classroom,i=t.goodsId;return{targetType:e?"course":"goods",targetId:e?this.courseId:i}}}),watch:{currentComponent:function(){this.$emit("chang-tabs-status","List"===this.currentComponent)}},created:function(){this.getUserReviews()},methods:{changeCurrentComponent:function(t){var e=t.component,i=t.data;A.a.assign(this,{currentComponent:e}),i&&(this.userReview=i)},getUserReviews:function(){var t=this;w.a.getReview({params:pt(pt({},this.targetInfo),{},{userId:this.user.id})}).then((function(e){var i=e.data;A.a.size(i)&&(t.userReview=i[0])}))}}},mt=Object(f.a)(ft,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"reviews"},[e(this.currentComponent,{tag:"component",attrs:{"user-review":this.userReview,"target-info":this.targetInfo,details:this.details},on:{"change-current-component":this.changeCurrentComponent}})],1)}),[],!1,null,null,null).exports;function vt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function gt(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?vt(Object(i),!0).forEach((function(e){Object(r.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):vt(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var yt={catalogue:{name:"",type:"catalogue"},question:{name:"firstDiscussion",type:"question"},discussion:{name:"secondDiscussion",type:"discussion"},notes:{name:"Notes",type:"notes"},evaluation:{name:"Reviews",type:"reviews"}},bt={inheritAttrs:!0,components:{GoodsItemBank:i("ba01").a,Directory:o.a,DetailHead:c.a,afterjoinDirectory:L,infoCollection:$.a,firstDiscussion:J,secondDiscussion:X,Notes:st,Reviews:mt,closedFixed:E.a},props:{details:{type:Object,value:function(){}}},data:function(){return{headBottom:0,active:0,scrollFlag:!1,tabs:["catalogue","courseItemBank"],tabFixed:!1,errorMsg:"",offsetTop:"",offsetHeight:"",isFixed:!1,isShowForm:!1,paramsList:{action:"buy_after",targetType:"course",targetId:this.details.id},show:!1,show_course_review:this.$store.state.goods.show_course_review,assistantShow:!1,showTabs:!0,showDrainage:!1,bindItemBankList:[],aiAgentSdk:null}},mixins:[D.a,P.a],computed:gt(gt(gt({},Object(l.e)("course",{selectedPlanId:function(t){return t.selectedPlanId},currentJoin:function(t){return t.currentJoin}})),Object(l.e)(["user","settingUgc"])),{},{progress:function(){return Number(this.details.publishedTaskNum)?parseInt(this.details.progress.percent)+"%":"0%"},isShowClosedFooter:function(){var t;return"closed"===(null===(t=this.details.courseSet)||void 0===t?void 0:t.status)},summary:function(){return this.details.summary||this.details.courseSet.summary},isClassCourse:function(){return Number(this.details.parentId)},currentTypeText:function(){return this.details.classroom?"班级":"课程"},isWeixin:function(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)},currentTabComponent:function(){var t=this.tabs,e=this.active;return yt[t[e]]}}),watch:{selectedPlanId:function(t,e){this.active=0},currentJoin:{handler:function(t,e){var i=this;t&&(a.a.loading({duration:0,message:"加载中...",forbidClick:!0}),this.getInfoCollectionEvent(this.paramsList).then((function(t){if(Object.keys(t).length)return i.userInfoCollect=t,void i.getInfoCollectionForm(t.id).then((function(t){i.isShowForm=!0,a.a.clear()}));a.a.clear()})))},immediate:!0},$route:function(t,e){this.resetFrom()},details:function(t,e){this.showDialog();var i=t.drainage;i&&"1"==i.enabled&&!localStorage.getItem("first_drainage")&&(this.showDrainage=!0,localStorage.setItem("first_drainage",1))}},mounted:function(){window.addEventListener("scroll",this.handleScroll),this.$nextTick((function(){var t=document.getElementById("course-detail__head").offsetHeight;this.offsetTop=t+46,this.offsetHeight=44})),this.getBindItemBank(),this.tryInitAIAgentSdk()},created:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.showDialog(),t.initTabs();case 2:case"end":return e.stop()}}),e)})))()},destroyed:function(){window.removeEventListener("scroll",this.handleScroll)},methods:gt(gt({},Object(l.d)("course",{setCurrentJoin:C.s,setSourceType:C.A})),{},{tryInitAIAgentSdk:function(){var t=this;w.a.meCourseMember({query:{id:this.$route.params.id}}).then((function(e){e.aiTeacherEnabled&&(t.aiAgentSdk=t.initAIAgentSdk(t.$store.state.user.aiAgentToken,{domainId:e.aiTeacherDomain,courseId:e.courseId,courseName:e.courseSetTitle},null,null,!0),e.studyPlanGenerated?t.aiAgentSdk.setVariable("studyPlanGenerated",!0):t.aiAgentSdk.setVariable("studyPlanGenerated",!1),t.aiAgentSdk.boot(),e.studyPlanGenerated||t.aiAgentSdk.showReminder({title:"HI，我是你的 AI 老师小知～",content:"欢迎加入《".concat(e.courseSetTitle,"》课程，我将在你学习的过程中为你提供专业答疑、督学提醒等学习服务，现在点击下方「制定学习计划」来生成专属学习计划吧！"),buttonContent:"plan.generate"}))}))},initTabs:function(){var t=this.settingUgc,e=t.thread,i=t.note,s=t.review;e.course_question_enable&&this.tabs.push("question"),e.course_thread_enable&&this.tabs.push("discussion"),i.course_enable&&this.tabs.push("notes"),s.course_enable&&this.tabs.push("evaluation")},gotoGoodsPage:function(){this.details.goodsId&&this.$router.push({path:"/goods/".concat(this.details.goodsId,"/show"),query:{targetId:this.details.id}})},showDialog:function(){if(this.details.member){var t="";if(this.details.member.access&&(t=this.details.member.access.code),t&&"success"!==t){this.errorMsg=this.getErrorMsg(t);var e="",i=function(){};if("course.expired"===t||"member.expired"===t&&!this.isClassCourse){e="课程已到期，无法继续学习，是否退出";var s={id:this.details.id};return i=function(){w.a.deleteCourse({query:s}).then((function(t){t.success?window.location.reload():a.a.fail("退出课程失败，请稍后重试")}))},void this.callConfirm(e,i)}var n=this.details.vipLevel?this.details.vipLevel.name:"",r={"vip.member_expired":{message:"您的会员已到期，会员".concat(this.currentTypeText,"已无法学习，请续费会员，或退出后重新购买").concat(this.currentTypeText,"。"),confirmButtonText:"续费会员",cancelButtonText:"退出".concat(this.currentTypeText)},"vip.not_member":{message:"您不是".concat(n,"，请购买").concat(n,"后兑换该").concat(this.currentTypeText,"学习。或退出后重新购买").concat(this.currentTypeText,"。"),confirmButtonText:"购买会员",cancelButtonText:"退出".concat(this.currentTypeText)},"vip.level_low":{message:"您不是".concat(n,"，请购买").concat(n,"后兑换该").concat(this.currentTypeText,"学习。或退出后重新购买").concat(this.currentTypeText,"。"),confirmButtonText:"购买会员",cancelButtonText:"退出".concat(this.currentTypeText)},"vip.level_not_exist":{message:"您不是".concat(n,"，请购买").concat(n,"后兑换该").concat(this.currentTypeText,"学习。或退出后重新购买").concat(this.currentTypeText,"。"),confirmButtonText:"购买会员",cancelButtonText:"退出".concat(this.currentTypeText)},"vip.vip_right_not_exist":{message:"很抱歉，该".concat(this.currentTypeText,"已不属于会员权益，请退出后重新购买。"),showConfirmButton:!1,cancelButtonText:"退出".concat(this.currentTypeText)}};r[t]?this.vipCallConfirm(r[t]):a.a.fail(this.errorMsg)}}},getErrorMsg:function(t){switch(t){case"course.not_found":return"当前课程不存在";case"course.unpublished":return"当前课程未发布";case"course.expired":return"当前课程已过期";case"course.not_arrive":return"当前课程还不能学习";case"user.not_login":return"用户未登录";case"user.locked":return"用户被锁定";case"member.not_found":return"用户未加入课程";case"member.expired":return"课程已过期";case"vip.vip_closed":return"网校已关闭会员功能";case"vip.not_login":return"用户未登录";case"vip.not_member":return"当前用户并不是vip";case"vip.member_expired":return"用户会员服务已过期";case"vip.level_not_exist":return"用户会员等级或课程会员不存在";case"vip.level_low":return"用户会员等级过低";default:return"异常错误"}},callConfirm:function(t,e){s.a.confirm({message:t,title:""}).then((function(){e()})).catch((function(){}))},vipCallConfirm:function(t){this.show=!0,s.a.confirm(gt(gt({},t),{},{title:"",confirmButtonColor:"#1895E7",cancelButtonColor:"#FD4852",messageAlign:"left",overlay:!1,beforeClose:this.beforeClose}))},clickCloseOverlay:function(){this.show=!1,s.a.close()},beforeClose:function(t,e){if("confirm"===t)return this.$router.push({path:"/vip",query:{id:this.details.vipLevel.id}}),void e();this.show&&("班级"==this.currentTypeText?this.deleteClassroom(e):this.deleteCourse(e))},deleteClassroom:function(t){var e=this,i=this.details.classroom,s=i.id,n=i.goodsId,r={id:s};w.a.deleteClassroom({query:r}).then((function(i){i.success&&(e.$router.replace({path:"/goods/".concat(n,"/show"),query:{backUrl:"/"}}),t())}))},deleteCourse:function(t){var e=this,i=this.details,s=i.id,n=i.goodsId,r={id:s};w.a.deleteCourse({query:r}).then((function(i){i.success&&(e.$router.replace({path:"/goods/".concat(n,"/show"),query:{targetId:s}}),t())}))},handleScroll:function(){var t=document.getElementById("swiper-directory"),e=document.documentElement.scrollHeight,i=document.documentElement.clientHeight;(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)>this.offsetTop&&e-this.offsetTop>i?(this.tabFixed=!0,t&&t.classList.add("swiper-directory-fix")):(this.tabFixed=!1,t&&t.classList.remove("swiper-directory-fix"))},onCancelForm:function(){this.setCurrentJoin(!1),this.isShowForm=!1},showAssistant:function(){this.assistantShow=!0},changTabsStatus:function(t){this.showTabs=t},getBindItemBank:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.getBindItemBank({params:{bindType:"course",bindId:t.$route.params.id}});case 2:t.bindItemBankList=e.sent;case 3:case"end":return e.stop()}}),e)})))()}})};function kt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function Ct(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?kt(Object(i),!0).forEach((function(e){Object(r.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):kt(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}i("6ce0");var wt={components:{joinAfter:Object(f.a)(bt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"join-after"},[i("detail-head",{attrs:{"course-set":t.details.courseSet}}),i("van-tabs",{directives:[{name:"show",rawName:"v-show",value:t.showTabs,expression:"showTabs"}],staticClass:"tabs",class:t.tabFixed?"isFixed":"",attrs:{"title-active-color":"#408ffb","title-inactive-color":"#666"},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.tabs,(function(e){return i("van-tab",{key:e,attrs:{title:t.$t("courseLearning."+e)}})})),1),i("div",{staticClass:"join-after__content"},[i("div",[0==t.active?i("div",{staticStyle:{position:"relative"}},[i("div",{staticClass:"course-info py-12",on:{click:t.gotoGoodsPage}},[i("div",{staticClass:"course-info__left"},[i("div",{staticClass:"title",class:{"title--full":!t.details.goodsId}},[t._v(t._s(t.details.courseSet&&t.details.courseSet.title))]),i("div",{staticClass:"learning-progress mt-8",class:{"learning-progress--full":!t.details.goodsId}},[i("div",{staticClass:"learning-progress__bar",style:{width:t.progress}}),i("div",{staticClass:"learning-progress__text"},[t._v("\n                "+t._s(t.progress)+"\n              ")])])]),t.details.goodsId?i("van-icon",{attrs:{name:"arrow"}}):t._e()],1),t.details.drainage&&"1"==t.details.drainage.enabled?i("div",{staticClass:"drainage-btn",on:{click:function(e){t.showDrainage=!0}}},[i("i",{staticClass:"iconfont icon-drainage",staticStyle:{"margin-right":"4px"}}),t._v("\n          "+t._s(t.$t("courseLearning.teachingService"))+"\n        ")]):t._e(),t.details.assistant&&t.details.assistant.weChatQrCode?i("div",{staticClass:"assistant"},[i("div",{staticClass:"assistant-btn",on:{click:t.showAssistant}},[i("div",{staticClass:"assistant-btn__text"},[i("i",{staticClass:"iconfont icon-weixin1"}),t._v("\n              "+t._s(t.$t("courseLearning.addTeachingAssistantWeChat"))+"\n            ")]),i("van-icon",{staticClass:"arrow-icon",attrs:{name:"arrow"}})],1),i("van-popup",{staticClass:"assistant-info",attrs:{position:"bottom",closeable:"",round:""},model:{value:t.assistantShow,callback:function(e){t.assistantShow=e},expression:"assistantShow"}},[i("img",{staticClass:"avatar",attrs:{src:t.details.assistant.avatar.middle,alt:t.$t("courseLearning.picture")}}),i("p",{staticClass:"nickname"},[t._v(t._s(t.details.assistant.nickname))]),i("p",{staticClass:"desc"},[t._v(t._s(t.$t("courseLearning.addTheTeachingAssistant")))]),i("img",{staticClass:"wechat",attrs:{src:t.details.assistant.weChatQrCode,alt:t.$t("courseLearning.qRCodePicture")}}),t.isWeixin?i("div",{staticClass:"tips"},[t._v(t._s(t.$t("courseLearning.longPressThePicture")))]):i("div",{staticClass:"tips"},[t._v(t._s(t.$t("courseLearning.longPressThePicture2")))])])],1):t._e(),i("afterjoin-directory",{attrs:{"error-msg":t.errorMsg,"course-set":t.details.courseSet},on:{showDialog:t.showDialog}}),t.isShowClosedFooter?i("div",{staticClass:"white-space"}):t._e()],1):t._e(),1==t.active?i("div",{staticStyle:{position:"relative"}},[0===t.bindItemBankList.length?i("div",[i("van-empty",{attrs:{description:"暂无题库"}})],1):i("div",{staticClass:"flex flex-col p-16 gap-12"},t._l(t.bindItemBankList,(function(t){return i("div",{key:t.id},[i("goods-item-bank",{attrs:{item:t}})],1)})),0)]):i(t.currentTabComponent.name,{tag:"component",attrs:{type:t.currentTabComponent.type,details:t.details},on:{"chang-tabs-status":t.changTabsStatus}})],1)]),i("van-action-sheet",{staticClass:"minHeight50",attrs:{title:t.userInfoCollectForm.formTitle,"close-on-click-overlay":!1,"safe-area-inset-bottom":!0},on:{cancel:t.onCancelForm},model:{value:t.isShowForm,callback:function(e){t.isShowForm=e},expression:"isShowForm"}},[i("info-collection",{attrs:{userInfoCollectForm:t.userInfoCollectForm,formRule:t.userInfoCollectForm.items},on:{submitForm:t.onCancelForm}})],1),i("van-overlay",{attrs:{show:t.show,"z-index":"1000"},on:{click:t.clickCloseOverlay}}),t.details.drainage&&"1"==t.details.drainage.enabled?i("van-popup",{staticClass:"drainage-popup",attrs:{round:"",closeable:"",position:"bottom"},model:{value:t.showDrainage,callback:function(e){t.showDrainage=e},expression:"showDrainage"}},[i("div",{staticClass:"drainage-popup__title"},[t._v(t._s(t.details.drainage.text))]),i("div",{staticClass:"drainage-popup__img"},[i("img",{staticStyle:{width:"200px",height:"200px","object-fit":"fill","max-width":"200px"},attrs:{src:t.details.drainage.image,alt:""}})]),i("van-button",{staticClass:"drainage-popup__btn",attrs:{type:"primary",block:""}},[t._v("\n      "+t._s(t.isWeixin?t.$t("courseLearning.longPressThePicture"):t.$t("courseLearning.longPressThePicture2"))+"\n    ")])],1):t._e(),i("div",{staticClass:"footer"},[t.isShowClosedFooter?i("closedFixed",{attrs:{isJoin:!0,title:t.$t("closed.courseTitle"),content:t.$t("closed.courseContent")}}):t._e()],1)],1)}),[],!1,null,"3a83285e",null).exports},computed:Ct(Ct({},Object(l.e)("course",{details:function(t){return t.details}})),Object(l.e)({isLoading:function(t){return t.isLoading}})),provide:function(){return{getDetailsContent:this.getData}},watch:{$route:function(t,e){this.getData()}},created:function(){this.getData()},methods:Ct(Ct(Ct({},Object(l.c)("course",["getCourseLessons"])),Object(l.d)("course",{setSourceType:C.A})),{},{getData:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getCourseLessons({courseId:t.$route.params.id}).then((function(e){var i;e.member||Number(t.details.parentId)||t.$router.push({path:"/goods/".concat(e.goodsId,"/show")}),"no"===(null===(i=e.contract)||void 0===i?void 0:i.sign)||0!=e.member.isContractSigned||t.signContractConfirm(e)}));case 2:case"end":return e.stop()}}),e)})))()},signContractConfirm:function(t){var e=this,i=t.contract,n=i.id,r=i.goodsKey,a=i.name;s.a.confirm({title:this.$t("contract.signContractTitle"),message:this.$t("contract.signContractTips",{name:a}),confirmButtonText:this.$t("contract.sign"),cancelButtonText:this.$t("contract.cancel")}).then((function(){e.$router.push({name:"signContract",params:{id:n,goodsKey:r}})})).catch((function(){"required"===t.contract.sign&&e.$router.go(-1)}))},getJoinAfter:function(){var t=this;this.getJoinAfterDetail({courseId:this.$route.params.id}).catch((function(e){t.$toast.fail(e.message)}))}}),beforeRouteEnter:function(t,e,i){("course"===t.name&&"testpaperResult"===e.name||"course"===t.name&&"testpaperIntro"===e.name)&&window.location.reload(),i()},beforeRouteLeave:function(t,e,i){this.setSourceType({sourceType:"img",taskId:0}),i()}},_t=Object(f.a)(wt,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"course-detail"},[this.isLoading?e("e-loading"):this._e(),e("join-after",{attrs:{details:this.details}})],1)}),[],!1,null,null,null);e.default=_t.exports}}]);